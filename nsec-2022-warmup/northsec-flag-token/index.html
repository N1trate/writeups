<!doctype html><html><head><title>Nitrate's writeups</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=revised content="2022-05-22T19:38:17 UTC"><title>NorthSec Flag Token :: Nitrate's writeups</title><link rel="shortcut icon" href=/writeups/images/favicon.png type=image/x-icon><link href=/writeups/css/nucleus.css rel=stylesheet><link href=/writeups/css/font-awesome.min.css rel=stylesheet><link href=/writeups/css/featherlight.min.css rel=stylesheet><link href=/writeups/css/auto-complete.css rel=stylesheet><link href=/writeups/theme-flex/style.css rel=stylesheet><link rel=stylesheet href=/writeups/css/bootstrap.min.css><link rel=stylesheet href=/writeups/css/custom.css></head><body data-url=/writeups/nsec-2022-warmup/northsec-flag-token/><header><div class=logo><a class=baselink href=https://n1trate.github.io/writeups>Nitrate's writeups</a></div><div class=burger><a href=javascript:void(0); style=font-size:15px>&#9776;</a></div></header><article><aside><ul class=menu><li data-nav-id=/writeups/ class=dd-item><a href=/writeups/><i class="fa fa-fw fa-home"></i></a></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022/ class="dd-item alwaysopen haschildren"><div><a href=/writeups/nsec-2022/>NSec 2022</a>
<i class="fa fa-angle-down fa-lg category-icon"></i></div><ul><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022/portobello-denial/ class=dd-item><div><a href=/writeups/nsec-2022/portobello-denial/>Portobello - Denial</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022/portobello-depression/ class=dd-item><div><a href=/writeups/nsec-2022/portobello-depression/>Portobello - Depression</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022/portobello-bargaining/ class=dd-item><div><a href=/writeups/nsec-2022/portobello-bargaining/>Portobello - Bargaining</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022/portobello-anger/ class=dd-item><div><a href=/writeups/nsec-2022/portobello-anger/>Portobello - Anger</a></div></li></ul></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/ class="dd-item alwaysopen haschildren"><div><a href=/writeups/nsec-2022-warmup/>NSec 2022 WarmUp</a>
<i class="fa fa-angle-down fa-lg category-icon"></i></div><ul><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/kitty/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/kitty/>Kitty!</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/warmup-challenge-logically/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/warmup-challenge-logically/>Warmup challenge, logically</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/the-flag-is-a-secret/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/the-flag-is-a-secret/>The Flag Is A Secret</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/toque-tracking/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/toque-tracking/>Toque Tracking</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/northsec-flag-token/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/northsec-flag-token/>NorthSec Flag Token</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/vlc-of-the-mariner/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/vlc-of-the-mariner/>VLC of the Mariner</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/whamazon/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/whamazon/>Whamazon</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/warmup-flag-actual/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/warmup-flag-actual/>warmup flag (actual)</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/hidden-harware-secrets/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/hidden-harware-secrets/>Hidden Hardware Secrets</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/fuzzforfun/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/fuzzforfun/>FuzzForFun</a></div></li><li data-nav-id=https://n1trate.github.io/writeups/nsec-2022-warmup/montr%C3%A9al-remix/ class=dd-item><div><a href=/writeups/nsec-2022-warmup/montr%C3%A9al-remix/>Montréal Remix</a></div></li></ul></li><li data-nav-id=https://n1trate.github.io/writeups/tools/ class="dd-item alwaysopen"><div><a href=/writeups/tools/>Tools</a></div></li></ul><section></section></aside><section class=page><div class=nav-select><center>Navigation :
<select onchange="location.href=this.value"><option value=/writeups/nsec-2022/>
NSec 2022</option><option value=/writeups/nsec-2022/portobello-denial/>
-
Portobello - Denial</option><option value=/writeups/nsec-2022/portobello-depression/>
-
Portobello - Depression</option><option value=/writeups/nsec-2022/portobello-bargaining/>
-
Portobello - Bargaining</option><option value=/writeups/nsec-2022/portobello-anger/>
-
Portobello - Anger</option><option value=/writeups/nsec-2022-warmup/>
NSec 2022 WarmUp</option><option value=/writeups/nsec-2022-warmup/kitty/>
-
Kitty!</option><option value=/writeups/nsec-2022-warmup/warmup-challenge-logically/>
-
Warmup challenge, logically</option><option value=/writeups/nsec-2022-warmup/the-flag-is-a-secret/>
-
The Flag Is A Secret</option><option value=/writeups/nsec-2022-warmup/toque-tracking/>
-
Toque Tracking</option><option value=/writeups/nsec-2022-warmup/northsec-flag-token/ selected>
-
NorthSec Flag Token</option><option value=/writeups/nsec-2022-warmup/vlc-of-the-mariner/>
-
VLC of the Mariner</option><option value=/writeups/nsec-2022-warmup/whamazon/>
-
Whamazon</option><option value=/writeups/nsec-2022-warmup/warmup-flag-actual/>
-
warmup flag (actual)</option><option value=/writeups/nsec-2022-warmup/hidden-harware-secrets/>
-
Hidden Hardware Secrets</option><option value=/writeups/nsec-2022-warmup/fuzzforfun/>
-
FuzzForFun</option><option value=/writeups/nsec-2022-warmup/montr%C3%A9al-remix/>
-
Montréal Remix</option><option value=/writeups/tools/>
Tools</option></select></center></div><div><div class=searchbox><input data-search-input id=search-by type=text placeholder=Search...></div></div><h1>NorthSec Flag Token</h1><p>Challenge statement:</p><pre tabindex=0><code>Jon is lost in the metaverse, and wants to get his hands on a sweet sweet NFT of this collection (alt link). Can you hack the blockchain to grab one for yourself?

RULES
DO NOT ATTACK WEBSITES, API OR USERS; DO NOT TRY TO BUY NFTs; ONLY USE PLAIN RINKEBY TESTNET BLOCKCHAIN INTERACTIONS!

Send me an Ethereum personal signature of &#34;NFT stands for NorthSec Flag Token&#34; (without quotes) from the wallet owning the NFT. Do not leak your signature as it can be used by anyone to solve the challenge. You can use https://app.mycrypto.com/sign-message or any other tools to create the signature which is a string that starts with 0x.
</code></pre><p>The collection can be seen <a href=https://testnets.opensea.io/collection/nsec-warmup-2022>here</a> or <a href=https://rinkeby.looksrare.org/collections/0x994f85881DB567b2d07ABb46Ad7814fA49EcAc77>here</a></p><p>The first step is to have access to an Eth wallet. The easiest way is to install MetaMask in your browser.</p><p>The second step is to get a bit of Eth to be able to generate transactions. We need to get some on faucets like <a href=https://faucets.chain.link/rinkeby>https://faucets.chain.link/rinkeby</a>.</p><p>By browsing the collection, we can see that a few token were owned by 0xc745a32262b944ABd01a119598BBB6e7654779a3 and 0x836A3cBEB8a962707a9387Db5C80bA9508a04Dc5. I had at first not seen, but the last NFT was owned by 0x0b055ded5fc8c8b107fcFD8f22B76E1C5D59490F.</p><p>We can scour the list of transactions done by that first address on <a href=https://rinkeby.etherscan.io/address/0xc745a32262b944abd01a119598bbb6e7654779a3>etherscan</a>. Most of the challenge was doable by using the etherscan website and looking at the Transactions and Contract tabs.</p><p>This <a href=https://rinkeby.etherscan.io/tx/0xb2e30fe81a2e72e9945b2bc3bfdfce2cb3d3fbdcb81bafb7c7437bd7d169cf21>transaction</a> is the creation of the contract for the challenge&rsquo;s NFT marketplace.</p><p>We can then go check the contract located at <a href=https://rinkeby.etherscan.io/address/0x994f85881db567b2d07abb46ad7814fa49ecac77>this address</a> which will probably have a lot of failed transactions by the time that you read this writeup. That address could also be found directly on the collection page, which would have been lightly faster.</p><p>We can see <a href=https://rinkeby.etherscan.io/tx/0xebfd506bf625ba6d59e6d246b5a327e2a779528c52880a6086799561f4cc273c>the</a> <a href=https://rinkeby.etherscan.io/tx/0xa9d1bafafe95a554a6e052f354da8deaa51a6d0328dd807e22a246ca31cd3642>first</a> <a href=https://rinkeby.etherscan.io/tx/0x14df0ca9067052133f62cde12ed8151230e291edc4faa5583a3c586832079595>three</a> NFT being minted directly on the marketplace, but that turned out to be a dead end.</p><p>Looking at the marketplace contract, we could also see two interesting transactions, one for <a href=https://rinkeby.etherscan.io/tx/0x8f93621aac1d196b816779bc2ab86689bff41efec5db24803d46e30f3f5618e7>Approve Admin</a> and one for <a href=https://rinkeby.etherscan.io/tx/0x85d9d9d2213227a7940d754dfa05617082f601085d5de3d8c16c18fca4aa7e35>Revoke Admin</a>. Those two specify the address <a href=https://rinkeby.etherscan.io/address/0x836a3cbeb8a962707a9387db5c80ba9508a04dc5>0x836a3cbeb8a962707a9387db5c80ba9508a04dc5</a>. Looking at that address&rsquo; transactions, we can see the creation of two Giveaway contracts, with the first one&rsquo;s giveaway function called twice, which created the NFT <a href=https://rinkeby.etherscan.io/tx/0x9887b2d39fc48d4230330e67b2161803e9b2102b844fcbde5271c47fed0e71f3>4</a> and <a href=https://rinkeby.etherscan.io/tx/0x15befb5eacfe5113dd7b4d8086358f6599e5c8411c917bf7491e72f38ddb3d57>5</a>.</p><p>Going on the <a href=https://rinkeby.etherscan.io/address/0x59c6dccc5abcab256747101ef0d4c4fe8b2b8367>Givaway contract</a> which created those NFT, we can call the giveaway function the same way and generate a new NFT that would be given to our address. The source address needed to be the marketplace, and the target our own address.</p><p>On the Contract tab, we can see the actual code behind the giveaway function:</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#007f7f>/**
</span></span></span><span style=display:flex><span><span style=color:#007f7f> * @title GiveAway NSEC2022 WARMUP
</span></span></span><span style=display:flex><span><span style=color:#007f7f> * @dev Give away NFTs!
</span></span></span><span style=display:flex><span><span style=color:#007f7f> */</span>
</span></span><span style=display:flex><span>contract GiveAway is CreatorExtensionBasic {
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    constructor() {}
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#007f7f>/**
</span></span></span><span style=display:flex><span><span style=color:#007f7f>     * @dev This public function is used to give away NFT!
</span></span></span><span style=display:flex><span><span style=color:#007f7f>     * @param source The source contract address to mint the NFT from
</span></span></span><span style=display:flex><span><span style=color:#007f7f>     * @param target The target wallet address to receive the minted NFT
</span></span></span><span style=display:flex><span><span style=color:#007f7f>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>function</span> giveaway(address source, address target) <span style=color:#fff;font-weight:700>public</span> {
</span></span><span style=display:flex><span>        IERC721CreatorCore(source).mintExtension(target);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The same function can be found at the bottom of the <a href=https://rinkeby.etherscan.io/address/0x62162e569f076d80173acda7cf53b1703cf7f32c#code>second Giveaway contract</a>.</p><p>From the marketplace, it was also possible to find the last original NFT owner&rsquo;s address in this <a href=https://rinkeby.etherscan.io/tx/0xbc4f3c621d8e6ea74fd96601cde3516499437c7a8b4d8e9ed2aefb2361d90ffe>transaction</a> which interacts with the first Giveaway contract to invoke the <a href=https://rinkeby.etherscan.io/tx/0xc8d444000f5a109352d179dbca65e8050dfeadeafe4b6121157527ecc75229f8>giveaway</a> function the same way, to create the sixth NFT.</p><p>If we keep looking at the transactions made by the marketplace creator, we can find one calling <a href=https://rinkeby.etherscan.io/tx/0x8ebfbe7504468e19c5db3ce0600658f04af86dc7d3575f57dff485219824679b>registerExtension</a> that is specifying the address of that first Giveaway contract. The second parameter, the baseURI, doesn&rsquo;t related to <a href=https://studio.api.manifoldxyz.dev/asset_uploader/asset/2852698318/metadata/full>https://studio.api.manifoldxyz.dev/asset_uploader/asset/2852698318/metadata/full</a> which contains metadata for the tokens.</p><p>After receiving the NFT, we had to sign a message and send it to the flag validator. The signature was done using <a href=https://app.mycrypto.com/sign-message>MyCrypto</a>, which generated a sig in the proper format.</p><div class=chevrons><div id=navigation></div></div></section></article><footer><div class=footline></div><div><p>Weeeeeeeeeeeeeeee</p></div></footer><script src=/writeups/js/jquery-2.x.min.js></script>
<script type=text/javascript>var baseurl="https://n1trate.github.io/writeups"</script><script src=/writeups/js/clipboard.min.js></script>
<script src=/writeups/js/featherlight.min.js></script>
<script type=text/javascript src=/writeups/js/lunr.min.js></script>
<script type=text/javascript src=/writeups/js/auto-complete.js></script>
<script type=text/javascript src=/writeups/js/search.js></script>
<script src=/writeups/theme-flex/script.js></script>
<script src=https://n1trate.github.io/writeups/js/scripts.min.js></script></body></html>